<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Jeck_Zhang]]></title>
  <subtitle><![CDATA[Write the Code. Change the World.]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://lawrence-zxc.github.io/"/>
  <updated>2014-10-27T09:28:43.085Z</updated>
  <id>http://lawrence-zxc.github.io/</id>
  
  <author>
    <name><![CDATA[Jeck Zhang]]></name>
    <email><![CDATA[xiongcaizhang@yahoo.com]]></email>
  </author>
  
  <generator uri="http://zespia.tw/hexo/">Hexo</generator>
  
  <entry>
    <title><![CDATA[正则表达式匹配中文]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/24/java-regex/"/>
    <id>http://lawrence-zxc.github.io/2014/10/24/java-regex/</id>
    <published>2014-10-24T08:58:25.000Z</published>
    <updated>2014-10-27T09:01:24.000Z</updated>
    <content type="html"><![CDATA[<p>匹配中文字符的正则表达式： <strong>[\u4e00-\u9fa5]</strong><br>匹配双字节字符(包括汉字在内)：<strong>[^\x00-\xff]</strong></p>
<p>js代码：</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^[u4E00-u9FA5]+$/</span>;</div><div class="line">    <span class="keyword">if</span>(!reg.test(str)){</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">   }</div><div class="line"><span class="keyword">return</span> <span class="literal">true</span>;</div></pre></td></tr></table></figure>

<p>java代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Pattern pattern = Pattern.compile(<span class="string">"[\u4e00-\u9fa5]"</span>);</div><div class="line">Matcher m = pattern.matcher(str);</div><div class="line"><span class="keyword">if</span> (m.matches()) {</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">} <span class="keyword">else</span> {</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<p>匹配中文字符的正则表达式： <strong>[\u4e00-\u9fa5]</strong><br>匹配双字节字符(包括汉字在内)：<strong>[^\x00-\xff]</strong></p>
<p>js代码：</p>
<figure class="highlight]]>
    </summary>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[秋]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/23/qiu/"/>
    <id>http://lawrence-zxc.github.io/2014/10/23/qiu/</id>
    <published>2014-10-23T06:14:35.000Z</published>
    <updated>2014-10-27T08:56:26.000Z</updated>
    <content type="html"><![CDATA[<p><br></p>
<h3 id="秋意渐浓">秋意渐浓</h3>
<center><br>    暑尽秋意浓，<br>    翘望满目空，<br>    西子斜阳里，<br>    游客独匆匆。<br></center>

<p><br></p>
<h3 id="晚秋">晚秋</h3>
<center><br>    秋风起，满地黄，<br>    朝为晨露暮凝霜，<br>    偏爱秋风抚落叶，<br>    不喜叶落树上光。<br></center>]]></content>
    <summary type="html">
    <![CDATA[<p><br></p>
<h3 id="秋意渐浓">秋意渐浓</h3>
<center><br>    暑尽秋意浓，<br>    翘望满目空，<br>    西子斜阳里，<br>    游客独匆匆。<br></center>

<p><br></p>
<h3 id="晚秋">晚]]>
    </summary>
    
      <category term="随感" scheme="http://lawrence-zxc.github.io/tags/%E9%9A%8F%E6%84%9F/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[RESTful Web Services中API的设计原则]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/14/blog2/"/>
    <id>http://lawrence-zxc.github.io/2014/10/14/blog2/</id>
    <published>2014-10-14T09:40:04.000Z</published>
    <updated>2014-10-27T08:56:52.000Z</updated>
    <content type="html"><![CDATA[<p>RESTful既然作为一种软件架构风格，那就自然就会有它本身的设计原则，就像iOS、android以及metroUI都有自己的设计规范一样。遵守基本的设计规则可以帮助我们设计出更加简洁易懂、优雅的软件系统。在这个过程中，程序员们都是艺术家，设计着另外一种美。</p>
<p>关于API的设计原则，我所知道的大部分来自书本、网上的资料以及参考各个开放平台的API规范。</p>
<pre><code><span class="title">RESTful</span> Web Services Cookbook
想要看书的话，可以买本来看，从名字就知道，这是一本手册，里面有设计API需要注意的所有方面。

RESTful API Design
Youtube上apigee关于API Desion的视频，讲的也很不错，请自备梯子。
</code></pre><p>豆瓣的API<br>    另外就是可以参考一下现有的开放平台API的设计，我比较喜欢设计，条理清晰，也很漂亮。apigee的视频中举的例子比较多的是facebook、twitter、LinkedIn等网站，参考已经实现的设计也是一个很好的学习方法。</p>
<p>API Design Tips</p>
<p>每个实体对象仅需要两个URL </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/books     # <span class="keyword">for</span> Collections</div><div class="line">/books/<span class="number">2</span>   # <span class="keyword">for</span> Single Object</div></pre></td></tr></table></figure>

<p>每个对象仅需要两个url，第一个是获取对象的集合，第二个是获取单个对象</p>
<p>使用名词代替动词</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/books/<span class="number">2</span>         # Good :)</div><div class="line">/getBook?id=<span class="number">2</span>    # Bad :(</div></pre></td></tr></table></figure>

<p>正确使用HTTP方法 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">GET     # Read</div><div class="line">POST    # Create</div><div class="line">PUT     # Update</div><div class="line">DELETE  # Delete</div></pre></td></tr></table></figure>

<p>对象间的关联关系 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/books/<span class="number">2</span>/author  # book author</div><div class="line">/author/<span class="number">1</span>/books  # author<span class="string">'s books</span></div></pre></td></tr></table></figure>

<p>数据分页 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/books?start=<span class="number">10</span>&count=<span class="number">20</span>   # <span class="keyword">return</span> the books from <span class="number">10</span> to <span class="number">30</span></div></pre></td></tr></table></figure>

<p>查询条件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/books?order=hot   # <span class="keyword">return</span> the books order by hot</div></pre></td></tr></table></figure>

<p>返回需要的参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/books/<span class="number">2</span>?fields=author,isbn,price   # only <span class="keyword">return</span> the book<span class="string">'s author, isbn and price</span></div></pre></td></tr></table></figure>

<p>错误处理<br>依靠status code来给程序标识错误，常见的status code如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="number">200</span> - OK             # GET success</div><div class="line"><span class="number">201</span> - CREATED        # POST success</div><div class="line"><span class="number">202</span> - ACCEPTED       # PUT success</div><div class="line"><span class="number">400</span> - BAD REQUEST    # Wrong path or unsupported parameters</div><div class="line"><span class="number">401</span> - UNAUTHORIZED   # Need Authorize</div><div class="line"><span class="number">403</span> - FORBIDDEN      # forbidden to access</div><div class="line"><span class="number">404</span> - NOT FOUND      # Resource not exists</div><div class="line"><span class="number">500</span> - INTERNAL ERROR # Server error</div></pre></td></tr></table></figure>

<p>具体的错误信息和错误代码（自定义的错误代码）也要返回： </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">{<span class="string">"code"</span>: <span class="number">1000</span>, <span class="string">"message"</span>: <span class="string">"missing_args"</span>, <span class="string">"request"</span>: <span class="string">"GET /books/2"</span>}</div></pre></td></tr></table></figure>

<p>身份认证 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Oauth <span class="number">2.0</span></div></pre></td></tr></table></figure>

<p>版本管理 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">GET   /books/<span class="number">2</span>      # version <span class="number">1</span></div><div class="line">GET   /v2/books/<span class="number">2</span>   # version <span class="number">2</span></div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<p>RESTful既然作为一种软件架构风格，那就自然就会有它本身的设计原则，就像iOS、android以及metroUI都有自己的设计规范一样。遵守基本的设计规则可以帮助我们设计出更加简洁易懂、优雅的软件系统。在这个过程中，程序员们都是艺术家，设计着另外一种美。</p>
<p>]]>
    </summary>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="架构" scheme="http://lawrence-zxc.github.io/tags/%E6%9E%B6%E6%9E%84/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[分享一个切换hosts的python脚本]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/11/switch-hosts/"/>
    <id>http://lawrence-zxc.github.io/2014/10/11/switch-hosts/</id>
    <published>2014-10-11T09:08:18.000Z</published>
    <updated>2014-10-27T09:15:32.000Z</updated>
    <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"></div><div class="line"><span class="comment">#################################################</span></div><div class="line"><span class="comment">#         左边网开发环境SwitchHosts Tools</span></div><div class="line"><span class="comment">#   (初始化开发环境,安装相关开发软件,服务器）</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#    V1.0      Writen by: zxc       Date:2014-10-11</span></div><div class="line"><span class="comment">##################################################</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">switchhosts</span><span class="params">()</span>:</span></div><div class="line">    hostsmap = {}</div><div class="line">    envlist = []</div><div class="line">    hosts = open(<span class="string">'/etc/hosts'</span>, <span class="string">'r'</span>)</div><div class="line">    current_env = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> hosts:</div><div class="line">        line = line.strip()</div><div class="line">        env_p = re.search(<span class="string">'^###\s*(\S+)\s*###$'</span>, line)</div><div class="line">        <span class="keyword">if</span> env_p <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            current_env = env_p.group(<span class="number">1</span>)</div><div class="line">            <span class="keyword">if</span> current_env <span class="keyword">in</span> envlist:</div><div class="line">                <span class="keyword">raise</span> <span class="string">'duplicate defined host env name: %s'</span> % current_env</div><div class="line">            envlist.append(current_env)</div><div class="line">            hostsmap[current_env] = [] </div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">if</span> current_env == <span class="string">''</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">        hostsmap[current_env].append(line)</div><div class="line">    hosts.close()</div><div class="line"></div><div class="line">    iter_idx = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> env_iter <span class="keyword">in</span> envlist:</div><div class="line">        <span class="keyword">print</span> <span class="string">'(%s) %s'</span> % (iter_idx, env_iter)</div><div class="line">        iter_idx = iter_idx+<span class="number">1</span></div><div class="line">    hostsmapCount = {}</div><div class="line">    <span class="keyword">for</span> env <span class="keyword">in</span> hostsmap:</div><div class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> hostsmap[env]:</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> line.startswith(<span class="string">'#'</span>):</div><div class="line">                <span class="keyword">if</span> env <span class="keyword">in</span> hostsmapCount:</div><div class="line">                    hostsmapCount[env] = hostsmapCount[env]+<span class="number">1</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    hostsmapCount[env] = <span class="number">1</span></div><div class="line">    current_env = <span class="keyword">None</span></div><div class="line">    max_count = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> env <span class="keyword">in</span> hostsmapCount:</div><div class="line">        <span class="keyword">if</span> env != <span class="string">'base'</span> <span class="keyword">and</span> hostsmapCount[env] &gt; max_count:</div><div class="line">            current_env = env </div><div class="line">            max_count = hostsmapCount[env]</div><div class="line">    <span class="keyword">if</span> max_count == <span class="number">0</span>:</div><div class="line">        current_env = <span class="string">'base'</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'current env: %s, chose your hosts env &gt; '</span> % current_env</div><div class="line">    env = envlist[int(sys.stdin.readline().strip())]</div><div class="line">    writehosts(env, envlist, hostsmap)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">writehosts</span><span class="params">(env, envlist, hostsmap)</span>:</span></div><div class="line">    hosts = open(<span class="string">'/etc/hosts'</span>, <span class="string">'w'</span>)</div><div class="line">    <span class="keyword">for</span> env_iter <span class="keyword">in</span> envlist:</div><div class="line">        hosts.write(<span class="string">'### %s ###'</span> % env_iter)</div><div class="line">        hosts.write(<span class="string">'\n'</span>)</div><div class="line">        desc = (env == env_iter <span class="keyword">or</span> env_iter == <span class="string">'base'</span>)</div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> hostsmap[env_iter]:</div><div class="line">            <span class="keyword">while</span> item.startswith(<span class="string">'#'</span>):</div><div class="line">                item = item[<span class="number">1</span> : len(item)]</div><div class="line">            <span class="keyword">if</span> desc:</div><div class="line">                hosts.write(<span class="string">'%s'</span> % item.strip())</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                hosts.write(<span class="string">'# %s'</span> % item.strip())</div><div class="line">            hosts.write(<span class="string">'\n'</span>)</div><div class="line">    hosts.close()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_example</span><span class="params">()</span>:</span></div><div class="line">    example = <span class="string">"""&gt; cat /etc/hosts</span></div><div class="line">### base ###</div><div class="line">127.0.0.1 localhost</div><div class="line">127.0.0.1 zxc-rMBP</div><div class="line">255.255.255.255    broadcasthost</div><div class="line">::1             localhost</div><div class="line">fe80::1%lo0    localhost</div><div class="line">91.213.30.151   www.google.com</div><div class="line">91.213.30.151   www.google.com.hk</div><div class="line">91.213.30.151   accounts.google.com</div><div class="line">91.213.30.151   accounts.google.com.hk</div><div class="line">91.213.30.151   mail.google.com</div><div class="line">91.213.30.151   mail.google.com.hk</div><div class="line">91.213.30.151   plus.google.com</div><div class="line">91.213.30.151   plus.google.com.hk</div><div class="line">### server190 ###</div><div class="line">192.168.0.190  web.zuobian.com</div><div class="line">### server150 ###</div><div class="line">192.168.0.150  web.zuobian.com</div><div class="line">### localdev ###</div><div class="line">127.0.0.1   web.zuobian.com</div><div class="line">### run ###</div><div class="line">"""</div><div class="line">    <span class="keyword">print</span> example</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span> <span class="keyword">and</span> (sys.argv[<span class="number">1</span>] == <span class="string">'-h'</span> <span class="keyword">or</span> sys.argv[<span class="number">1</span>] == <span class="string">'-help'</span>):</div><div class="line">        <span class="keyword">print</span> <span class="string">'usage: defined /etc/hosts and run switchhosts.py, make sure /etc/hosts writeable, example:'</span></div><div class="line">        print_example()</div><div class="line">        sys.exit(<span class="number">1</span>)</div><div class="line">    switchhosts()</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</d]]>
    </summary>
    
      <category term="Python" scheme="http://lawrence-zxc.github.io/tags/Python/"/>
    
      <category term="Linux" scheme="http://lawrence-zxc.github.io/tags/Linux/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[mysql多列索引详解]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/09/blog4/"/>
    <id>http://lawrence-zxc.github.io/2014/10/09/blog4/</id>
    <published>2014-10-09T06:48:10.000Z</published>
    <updated>2014-10-24T09:50:15.000Z</updated>
    <content type="html"><![CDATA[<p>创建多列索引</p>
<p>在t_user表id，userName，email字段上创建多列索引（该表只有此索引）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alter table t_user add index USER_INDEX(id, userName, email);</div></pre></td></tr></table></figure>

<p>能够利用该索引的查询</p>
<p>符合leftmost index prefixes原则的查询</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">select * from t_user where id = <span class="number">40</span>;</div><div class="line">select * from t_user where id between <span class="number">10</span> and <span class="number">50</span>;</div><div class="line">select * from t_user where id <span class="keyword">in</span> (<span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>);</div><div class="line">select * from t_user where id = <span class="number">40</span> and userName = <span class="string">'zxc'</span>;</div><div class="line">select * from t_user where id = <span class="number">40</span> and userName = <span class="string">'zxc'</span> and email = <span class="string">'xiongcaizhang@yahoo.com'</span>;</div><div class="line">select * from t_user where id &gt; <span class="number">40</span> and userName &gt; <span class="string">'t'</span>;</div></pre></td></tr></table></figure>

<p>不能利用以上索引的查询</p>
<p>不符合leftmost index prefixes原则的查询</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">select * from t_user where userName = <span class="string">'zxc'</span>;</div><div class="line">select * from t_user where userName = <span class="string">'zxc'</span> and email = <span class="string">'xiongcaizhang@yahoo.com'</span>;</div></pre></td></tr></table></figure>

<p>or查询</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">select * from t_user where id = <span class="number">40</span> or userName = <span class="string">'zxc'</span>;</div></pre></td></tr></table></figure>

<p>不能使用索引的解决方案</p>
<p>在where语句后面的查询字段建立单个索引及多列索引，注意leftmost index prefixes原则，避免建立重复索引</p>
<p>or查询使用union来连接查询结果，并在对应的字段上建立索引</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>创建多列索引</p>
<p>在t_user表id，userName，email字段上创建多列索引（该表只有此索引）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div cla]]>
    </summary>
    
      <category term="Mysql" scheme="http://lawrence-zxc.github.io/tags/Mysql/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[琐忆]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/05/rizhi/"/>
    <id>http://lawrence-zxc.github.io/2014/10/05/rizhi/</id>
    <published>2014-10-05T09:10:34.000Z</published>
    <updated>2014-10-27T08:57:11.000Z</updated>
    <content type="html"><![CDATA[<center><br>    年年如是，<br>    年年不同，<br>    依稀往事，<br>    如梦如风。<br></center>]]></content>
    <summary type="html">
    <![CDATA[<center><br>    年年如是，<br>    年年不同，<br>    依稀往事，<br>    如梦如风。<br></center>]]>
    </summary>
    
      <category term="开始" scheme="http://lawrence-zxc.github.io/tags/%E5%BC%80%E5%A7%8B/"/>
    
      <category term="Mac/Unix" scheme="http://lawrence-zxc.github.io/tags/Mac-Unix/"/>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="JavaScript" scheme="http://lawrence-zxc.github.io/tags/JavaScript/"/>
    
      <category term="Mongodb" scheme="http://lawrence-zxc.github.io/tags/Mongodb/"/>
    
      <category term="Linux" scheme="http://lawrence-zxc.github.io/tags/Linux/"/>
    
      <category term="Nginx" scheme="http://lawrence-zxc.github.io/tags/Nginx/"/>
    
      <category term="Oracle" scheme="http://lawrence-zxc.github.io/tags/Oracle/"/>
    
      <category term="Mysql" scheme="http://lawrence-zxc.github.io/tags/Mysql/"/>
    
      <category term="前端" scheme="http://lawrence-zxc.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="技术" scheme="http://lawrence-zxc.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="旅行" scheme="http://lawrence-zxc.github.io/tags/%E6%97%85%E8%A1%8C/"/>
    
      <category term="理财" scheme="http://lawrence-zxc.github.io/tags/%E7%90%86%E8%B4%A2/"/>
    
      <category term="生活" scheme="http://lawrence-zxc.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
      <category term="读书" scheme="http://lawrence-zxc.github.io/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="随感" scheme="http://lawrence-zxc.github.io/tags/%E9%9A%8F%E6%84%9F/"/>
    
      <category term="其他" scheme="http://lawrence-zxc.github.io/tags/%E5%85%B6%E4%BB%96/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[关于我]]></title>
    <link href="http://lawrence-zxc.github.io/2014/10/01/aboutMe/"/>
    <id>http://lawrence-zxc.github.io/2014/10/01/aboutMe/</id>
    <published>2014-10-01T06:55:13.000Z</published>
    <updated>2014-10-27T08:41:38.000Z</updated>
    <content type="html"><![CDATA[<h3 id="张兄才">张兄才</h3>
<p>90后程序员，@上海，业余承接java/python项目，Blogger。<br>12年毕业，本科数学，先后就职于 <a href="http://www.yueji.com" target="_blank" rel="external">悦己网</a>、<a href="http://www.iwjw.com" target="_blank" rel="external">爱屋及屋</a>、<a href="http://www.lvmama.com/" target="_blank" rel="external">驴妈妈</a>、<a href="http://www.zuobian.com" target="_blank" rel="external">左边网</a>，现任左边网Java技术负责人。</p>
<h3 id="技术领域：">技术领域：</h3>
<p><code>Java</code>、<code>Python</code>、<code>Oracle</code>、<code>Mysql</code>、<code>Ruby</code>、<code>Linux/Unix</code>、<code>JavaScript</code>、<code>Css/Html</code></p>
<h3 id="足迹">足迹</h3>
<ul>
<li><img src="/img/zhihu.png" width="16" height="16">知乎：<a href="http://www.zhihu.com/people/zhang-xiong-cai" target="_blank" rel="external">http://www.zhihu.com/people/zhang-xiong-cai</a></li>
<li><img src="/img/weibo.png">微博: <a href="http://weibo.com/zxc337" target="_blank" rel="external">@zxc337</a></li>
<li><img src="/img/yahoo.png">邮箱：xiongcaizhang@yahoo.com</li>
<li><img src="/img/qq.png">QQ：407815772</li>
<li><img src="/img/twitter.png">twitter: <a href="http://twitter.com/zxc337" target="_blank" rel="external">@zxc337</a></li>
<li><img src="/img/facebook.png">facebook: <a href="https://www.facebook.com/zxc337" target="_blank" rel="external">@Jeck Zhang</a></li>
<li><img src="/img/quora.png">Quora: <a href="http://quora.com/Jeck-Zhang" target="_blank" rel="external">@Jeck Zhang</a></li>
<li><img src="/img/gmail.png">Gmail: zhangxiongcai337#gmail.com(把#换成@)</li>
<li><img src="/img/github.png">Github: <a href="https://github.com/Lawrence-zxc" target="_blank" rel="external">@Lawrence-zxc</a></li>
<li><img src="/img/dribbble.png">Dribbble: <a href="http://dribbble.com/zxc337" target="_blank" rel="external">@zxc337</a></li>
</ul>
<h3 id="咖啡">咖啡</h3>
<p>如果您觉得『Jeck_Zhang Blog』对您的工作和生活有价值，欢迎对Jeck_Zhang进行无负担小额赞助(1元即可)：</p>
<ul>
<li><strong>支付宝帐号</strong>: 407815772@qq.com</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="张兄才">张兄才</h3>
<p>90后程序员，@上海，业余承接java/python项目，Blogger。<br>12年毕业，本科数学，先后就职于 <a href="http://www.yueji.com" target="_blank" rel="exter]]>
    </summary>
    
      <category term="开始" scheme="http://lawrence-zxc.github.io/tags/%E5%BC%80%E5%A7%8B/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[centos install oracle 11g]]></title>
    <link href="http://lawrence-zxc.github.io/2014/09/21/centos-install-oracle/"/>
    <id>http://lawrence-zxc.github.io/2014/09/21/centos-install-oracle/</id>
    <published>2014-09-21T13:03:03.000Z</published>
    <updated>2014-10-27T09:06:23.000Z</updated>
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/mnt/database/runInstaller -silent -ignoreSysPrereqs  -debug -force FROM_LOCATION=/mnt/database/stage/products.xml oracle.install.option=INSTALL_DB_SWONLY  UNIX_GROUP_NAME=oinstall INVENTORY_LOCATION=/mnt/oraInventory ORACLE_HOME=/mnt/oracle/product/<span class="number">11.2</span>.<span class="number">0</span>/db_1 ORACLE_HOME_NAME=<span class="string">"Oracle11"</span> ORACLE_BASE=/mnt/oracle oracle.install.db.InstallEdition=EE oracle.install.db.isCustomInstall=<span class="literal">false</span>   oracle.install.db.DBA_GROUP=oinstall  oracle.install.db.OPER_GROUP=oinstall</div><div class="line">DECLINE_SECURITY_UPDATES=<span class="literal">true</span></div></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dbca -silent -createDatabase -templateName General_Purpose.dbc -gdbname zuobian -sid zuobian -responseFile NO_VALUE -characterSet AL32UTF8 -memoryPercentage <span class="number">30</span> -emConfiguration LOCAL</div></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> zuobian_data datafile <span class="string">'/mnt/oracle/oradata/zuobian/zuobian_data01.bdf'</span> <span class="keyword">size</span> <span class="number">5120</span>M,  <span class="string">'/mnt/oracle/oradata/zuobian/zuobian_data02.bdf'</span> <span class="keyword">size</span> <span class="number">5120</span>M EXTENT MANAGEMENT <span class="keyword">LOCAL</span>;</span></div></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">tablespace</span> zuobian_data <span class="keyword">add</span>  datafile <span class="string">'/mnt/oracle/oradata/zuobian/zuobian_data01.bdf'</span> <span class="keyword">size</span> <span class="number">800</span>M  autoextend <span class="keyword">on</span> <span class="keyword">next</span> <span class="number">50</span>M  maxsize <span class="number">1000</span>M;</span></div></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TRAVEL_GIFTCLASS (</span></div><div class="line"> 	GC_ID             <span class="built_in">NUMBER</span>(<span class="number">10</span>)        <span class="keyword">NOT</span> <span class="literal">NULL</span>, </div><div class="line">    GMT_CREATE        <span class="keyword">TIMESTAMP</span>         <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">    GMT_MODIFIED      <span class="keyword">TIMESTAMP</span>         <span class="keyword">NOT</span> <span class="literal">NULL</span>, </div><div class="line">    GC_NAME           VARCHAR2(<span class="number">200</span>),   </div><div class="line">    GC_PARENTID       <span class="built_in">NUMBER</span>(<span class="number">10</span>) </div><div class="line">);</div></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">user</span> zuobian <span class="keyword">identified</span> <span class="keyword">by</span> zuobian <span class="keyword">default</span> <span class="keyword">tablespace</span> zuobian_data;</span></div></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">grant</span> <span class="keyword">connect</span>,resource,dba <span class="keyword">to</span> zuobian;</span></div><div class="line"><span class="operator"><span class="keyword">grant</span> <span class="keyword">connect</span>,resource <span class="keyword">to</span> zuobian;</span></div><div class="line"><span class="operator"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">view</span> <span class="keyword">to</span> zuobian;</span></div><div class="line"><span class="operator"><span class="keyword">grant</span> <span class="keyword">read</span>,<span class="keyword">write</span> <span class="keyword">on</span> directory dump_dir <span class="keyword">to</span> zuobian;</span></div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="co]]>
    </summary>
    
      <category term="Linux" scheme="http://lawrence-zxc.github.io/tags/Linux/"/>
    
      <category term="Oracle" scheme="http://lawrence-zxc.github.io/tags/Oracle/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Nginx+Lua+GraphicsMagick实现动态生成指定尺寸的图片]]></title>
    <link href="http://lawrence-zxc.github.io/2014/09/18/blog3/"/>
    <id>http://lawrence-zxc.github.io/2014/09/18/blog3/</id>
    <published>2014-09-18T07:12:39.000Z</published>
    <updated>2014-10-24T09:48:30.000Z</updated>
    <content type="html"><![CDATA[<p>面临的问题<br>网站需求变更，需要更多不同尺寸的缩略图</p>
<p>有些图片的缩略图很少使用到，但还是存在了硬盘上，造成空间浪费</p>
<p>解决方法<br>Nginx搭配Lua模块，如果访问的图片不存在，则调用GraphicsMagick的命令行实时生成指定尺寸的图片。</p>
<p>-集成了Lua模块的Nginx项目OpenResty</p>
<p>-GraphicsMagick的安装和使用</p>
<p>-具体使用方法</p>
<p>原始图片地址：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/images/f47aa98b47b4b7bd.jpg</div></pre></td></tr></table></figure>

<p>自定义图片尺寸：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/images/f47aa98b47b4b7bd_40x40.jpg</div></pre></td></tr></table></figure>

<p>配置文件中可以写成这样</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">location ~ <span class="string">'/images/([0-9a-z]+)_([0-9]+)x([0-9]+).jpg$'</span> {</div><div class="line">    root /home/images;</div><div class="line">    <span class="keyword">set</span> <span class="variable">$image_root</span> =  <span class="string">'/home/images'</span>;</div><div class="line">    <span class="keyword">set</span> <span class="variable">$fileName</span> = ngx.arg[<span class="number">1</span>];</div><div class="line">    <span class="keyword">set</span> <span class="variable">$width</span> = ngx.arg[<span class="number">2</span>];</div><div class="line">    <span class="keyword">set</span> <span class="variable">$height</span> = ngx.arg[<span class="number">3</span>];</div><div class="line">    <span class="keyword">set</span> <span class="variable">$origin</span> = <span class="variable">$image_root</span>/<span class="variable">$fileName</span>.jpg</div><div class="line">    <span class="keyword">set</span> <span class="variable">$file</span> = <span class="variable">$image_root</span>/<span class="variable">$fileName_</span><span class="variable">$widthx</span><span class="variable">$height</span>.jpg</div><div class="line">    <span class="keyword">if</span> (!<span class="operator">-f</span> <span class="variable">$file</span>) {</div><div class="line">        rewrite_by_lua <span class="string">'</span></div><div class="line">            local command = "gm convert "..ngx.var.origin.." -thumbnail "..ngx.var.width.."x"</div><div class="line">                            ..ngx.var.height.." "..ngx.var.file;</div><div class="line">            os.execute(command);</div><div class="line">         ';</div><div class="line"> }</div></pre></td></tr></table></figure>

<p>这样就能简单的生成图片指定尺寸的缩略图了。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>面临的问题<br>网站需求变更，需要更多不同尺寸的缩略图</p>
<p>有些图片的缩略图很少使用到，但还是存在了硬盘上，造成空间浪费</p>
<p>解决方法<br>Nginx搭配Lua模块，如果访问的图片不存在，则调用GraphicsMagick的命令行实时生成指定尺寸的图]]>
    </summary>
    
      <category term="Nginx" scheme="http://lawrence-zxc.github.io/tags/Nginx/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[REST风格的软件架构]]></title>
    <link href="http://lawrence-zxc.github.io/2014/09/05/blog1/"/>
    <id>http://lawrence-zxc.github.io/2014/09/05/blog1/</id>
    <published>2014-09-05T06:10:03.000Z</published>
    <updated>2014-10-24T09:43:01.000Z</updated>
    <content type="html"><![CDATA[<p>REST风格的软件架构</p>
<p>作者：侯西阳 时间：June 2, 2013 分类：RESTful<br>REST(REpresentational State Transfer)，表征状态转移，是一种针对分布式架构的软件架构风格，这种软件架构风格已经被广泛的应用在了Web API的设计上面，具有以下几个特点：</p>
<pre><code><span class="title">Resources</span> 一切都是资源
</code></pre><p>分布在整个网络中的内容都是一种资源，并由URI来确定，资源可以是文本、图片、服务等实体的存在，并用URI来提供这种资源，例如， /book/2 可以用来提供id为2的一本书。</p>
<pre><code><span class="title">Representation</span> 表现层
</code></pre><p>资源是一种实体，需要通过一种形式表现出来，这种形式可以是HTML、XML、JSON等文本格式，也可以是图片、音频或视频等多媒体格式，例如，通过访问 /book/2 返回了一下JSON数据：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">{</div><div class="line">    <span class="string">"title"</span>: <span class="string">"Gone with the Wind"</span>,</div><div class="line">    <span class="string">"author"</span>: <span class="string">"Margaret Mitchell"</span> </div><div class="line">}</div></pre></td></tr></table></figure>

<p>JSON数据就这本书的表现层。</p>
<p>State Transfer 显示的使用HTTP方法来转化资源的状态</p>
<p>使用HTTP规范中的GET、POST、PUT、DELETE方法来操作资源，例如</p>
<pre><code>GET <span class="regexp">/book/</span><span class="number">2</span>
</code></pre><p>可以获得id为2的一本书，HTTP方法与操作资源的对应关系如下</p>
<pre><code>POST 创建或更新资源

GET 获取资源

PUT 更新资源

<span class="keyword">DELETE</span> 删除资源
</code></pre><p>举例如下：<br>同样是访问 /book/2，</p>
<pre><code>POST 创建一本书

GET 获取一本的信息

PUT 更新书的信息

<span class="keyword">DELETE</span> 删除id为<span class="number">2</span>的书

Stateless 无状态
</code></pre><p>服务器端不会保存请求之间的上下文状态。</p>
<pre><code>Client-Server 基于<span class="keyword">C</span>/S结构
</code></pre><p>Client端不关心数据如何存储，Server端也不关心怎样展现数据，因此，Client和Server可以分开部署，适用于iOS与Android等移动客户端与Server端的通信。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>REST风格的软件架构</p>
<p>作者：侯西阳 时间：June 2, 2013 分类：RESTful<br>REST(REpresentational State Transfer)，表征状态转移，是一种针对分布式架构的软件架构风格，这种软件架构风格已经被广泛的应用在了]]>
    </summary>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="架构" scheme="http://lawrence-zxc.github.io/tags/%E6%9E%B6%E6%9E%84/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[java中使HttpDelete可以发送body信息]]></title>
    <link href="http://lawrence-zxc.github.io/2014/07/11/java-http/"/>
    <id>http://lawrence-zxc.github.io/2014/07/11/java-http/</id>
    <published>2014-07-11T02:32:48.000Z</published>
    <updated>2014-10-24T09:35:37.000Z</updated>
    <content type="html"><![CDATA[<p>RESTful api中用到了DELETE方法，android开发的同事遇到了问题，使用HttpDelete执行DELETE操作的时候，不能携带body信息，研究了很久之后找到了解决方法。 我们查看httpclient-4.2.3的源码可以发现，methods包下面包含HttpGet, HttpPost, HttpPut, HttpDelete等类来实现http的常用操作。 其中，HttpPost继承自HttpEntityEnclosingRequestBase，HttpEntityEnclosingRequestBase类又实现了HttpEntityEnclosingRequest接口，实现了setEntity的方法。 而HttpDelete继承自HttpRequestBase，没有实现setEntity的方法，因此无法设置HttpEntity对象。 这样解决方法就明显了，我们可以自己实现一个MyHttpDelete类，继承自HttpEntityEnclosingRequestBase，覆盖其中的getMethod方法，使其返回“DELETE”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHttpDelete</span> <span class="keyword">extends</span> <span class="title">HttpEntityEnclosingRequestBase</span> </span>{</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_NAME = <span class="string">"DELETE"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> String <span class="title">getMethod</span>() {</div><div class="line">        <span class="keyword">return</span> METHOD_NAME;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="title">MyHttpDelete</span>(<span class="keyword">final</span> String uri) {</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        setURI(URI.create(uri));</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="title">MyHttpDelete</span>(<span class="keyword">final</span> URI uri) {</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        setURI(uri);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="title">MyHttpDelete</span>() {</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>使用delete方法时，直接可以按下面方式操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DefaultHttpClient httpClient = <span class="keyword">new</span> DefaultHttpClient(); </div><div class="line"></div><div class="line">MyHttpDelete delete = <span class="keyword">new</span> MyHttpDelete(<span class="string">"http://url.com"</span>); </div><div class="line"></div><div class="line">List&lt;NameValuePair&gt; nameValuePairs = <span class="keyword">new</span> ArrayList&lt;NameValuePair&gt;(); </div><div class="line"></div><div class="line">delete.setEntity(<span class="keyword">new</span> UrlEncodedFormEntity(nameValuePairs)); </div><div class="line"></div><div class="line">HttpResponse response = httpClient.execute(delete);</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<p>RESTful api中用到了DELETE方法，android开发的同事遇到了问题，使用HttpDelete执行DELETE操作的时候，不能携带body信息，研究了很久之后找到了解决方法。 我们查看httpclient-4.2.3的源码可以发现，methods包下面包含Ht]]>
    </summary>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[按进程消耗内存多少排序]]></title>
    <link href="http://lawrence-zxc.github.io/2014/06/27/linux-ps/"/>
    <id>http://lawrence-zxc.github.io/2014/06/27/linux-ps/</id>
    <published>2014-06-27T01:52:00.000Z</published>
    <updated>2014-10-27T08:55:42.000Z</updated>
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps -eo rss,pmem,pcpu,vsize,args |  sort -k <span class="number">1</span> -r -n | less</div></pre></td></tr></table></figure>

<p>解析一下：<br><code>ps</code> 都知道，是linux,unix显示进程信息的,<br><code>-e</code> 是显示所有进程,<br><code>-o</code>是定制显示信息的格式</p>
<p> <code>rss</code>: resident set size, 表示进程占用RAM(内存)的大小，单位是KB<br> <code>pmem</code>: %M, 占用内存的百分比 </p>
<p> <code>pcpu</code>：%C，占用cpu的百分比<br> <code>vsize</code>: 表示进程占用的虚拟内存的大小，KB</p>
<p> <code>args</code>：进程名（command） </p>
<p> <code>sort</code>命令对ps结果进行排序<br>   <code>-k 1</code>:按第一个参数 rss进行排序</p>
<p>   <code>-r</code>：逆序<br>   <code>-n</code>：numeric，按数字来排序</p>
]]></content>
    <summary type="html">
    <![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line]]>
    </summary>
    
      <category term="Linux" scheme="http://lawrence-zxc.github.io/tags/Linux/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[tomcat关闭时dubbo consumer导致jvm进程无法退出的问题]]></title>
    <link href="http://lawrence-zxc.github.io/2014/06/18/hello/"/>
    <id>http://lawrence-zxc.github.io/2014/06/18/hello/</id>
    <published>2014-06-18T08:15:01.000Z</published>
    <updated>2014-10-24T09:24:31.000Z</updated>
    <content type="html"><![CDATA[<p>在apache-tomcat托管的应用里如果使用了dubbo的消费端，关闭tomcat时，会无法退出进程，应用会被关闭，connector端口也关闭了，但dubbo相关的一些线程仍存在，导致java进程并不会消失。</p>
<p>这其实是由非daemon线程引起的，jvm里当前main线程在退出时，只要存在非daemon的子线程，就不会退出jvm，哪怕这个非daemon的线程是在一个daemon线程里启动的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaemonTest</span> </span>{</div><div class="line"></div><div class="line">    <span class="keyword">static</span> class MyThread extends Thread {</div><div class="line">        <span class="keyword">public</span> <span class="title">MyThread</span>(<span class="keyword">boolean</span> isDaemon){</div><div class="line">            <span class="keyword">this</span>.setDaemon(isDaemon);</div><div class="line">        }</div><div class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span>(){</div><div class="line">            <span class="keyword">try</span> {</div><div class="line">                Thread.sleep(<span class="number">1000</span>*<span class="number">10000</span>);;</div><div class="line">            } <span class="keyword">catch</span> (Exception e) {</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(String[] args) <span class="keyword">throws</span> Exception{</div><div class="line">        Thread t1 = <span class="keyword">new</span> MyThread(<span class="keyword">true</span>);</div><div class="line">        Thread t2 = <span class="keyword">new</span> MyThread(<span class="keyword">true</span>);</div><div class="line">        Thread t3 = <span class="keyword">new</span> MyThread(<span class="keyword">true</span>);</div><div class="line">        Thread t4 = <span class="keyword">new</span> MyThread(<span class="keyword">true</span>) {</div><div class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span>() {</div><div class="line">                <span class="keyword">try</span> {</div><div class="line">                    <span class="keyword">new</span> MyThread(<span class="keyword">false</span>).start(); <span class="comment">//非daemon</span></div><div class="line">                    Thread.sleep(<span class="number">1000</span> * <span class="number">10000</span>);</div><div class="line">                } <span class="keyword">catch</span> (Exception e) {</div><div class="line">                }</div><div class="line">            }</div><div class="line">        };</div><div class="line"></div><div class="line"></div><div class="line">        t1.start();</div><div class="line">        t2.start();</div><div class="line">        t3.start();</div><div class="line">        t4.start();</div><div class="line"></div><div class="line">        Thread.sleep(<span class="number">2000</span>);</div><div class="line">        System.out.println(<span class="string">"main thread quit"</span>);</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>上面启动了4个子线程，都是daemon的，其中有一个子线程又启动了一个非daemon线程，结果主线程退出时，jvm进程并不会退出，并且其他daemon线程也继续运行。</p>
<p>Dubbo的线程都是daemon的，不过它使用的netty框架却有一个非daemon的“Hashed wheel timer”线程：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="string">"Hashed wheel timer #1"</span> #<span class="number">1582</span> prio=<span class="number">5</span> os_prio=<span class="number">0</span> tid=<span class="number">0x00002aaac5054800</span> nid=<span class="number">0x7fd3</span> waiting on condition [<span class="number">0x0000000041262000</span>]</div><div class="line">   java.lang.Thread.State: TIMED_WAITING (sleeping)</div><div class="line">    at java.lang.Thread.sleep(Native Method)</div><div class="line">    at org.jboss.netty.util.HashedWheelTimer$Worker.waitForNextTick(HashedWheelTimer.java:<span class="number">459</span>)</div><div class="line">    at org.jboss.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:<span class="number">376</span>)</div><div class="line">    at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:<span class="number">108</span>)</div><div class="line">    at java.lang.Thread.run(Thread.java:<span class="number">745</span>)</div></pre></td></tr></table></figure>

<p>正是这个非daemon线程，导致tomcat的主线程退出后，jvm进程没能退出。类似的问题以前在HSF2里也存在，后来已经解决了。dubbo的这个问题可以通过kill来结束。</p>
<p>在tomcat的脚本里，先使用正常的方式(viaport)停止tomcat，在不成功之后会尝试”kill”方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># stop failed. Shutdown port disabled? Try a normal kill.</div><div class="line"><span class="keyword">if</span> [ $? != <span class="number">0</span> ]; then</div><div class="line">    <span class="keyword">if</span> [ ! -z <span class="string">"$CATALINA_PID"</span> ]; then</div><div class="line">      echo <span class="string">"The stop command failed. Attempting to signal the process to stop through OS signal."</span></div><div class="line">      kill -<span class="number">15</span> `cat <span class="string">"$CATALINA_PID"</span>` &gt;/dev/<span class="keyword">null</span> <span class="number">2</span>&gt;&<span class="number">1</span></div><div class="line">    fi</div><div class="line">fi</div></pre></td></tr></table></figure>

<p>但这里的一个问题是”$CATALINA_PID”默认并没有被记录起来，所以没有执行kill，需要运维人员主意这一点。</p>
<p>// 补充<br>发现这个问题并不是一定发生的，只在dubbo发生了某种异常的情况下会有。正常情况下tomcat关闭(viaport方式)还是可以让jvm进程退出的(估计dubbo或netty有逻辑去处理那个timer线程），但这个异常是怎么回事产生的暂没有精力去跟踪了。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>在apache-tomcat托管的应用里如果使用了dubbo的消费端，关闭tomcat时，会无法退出进程，应用会被关闭，connector端口也关闭了，但dubbo相关的一些线程仍存在，导致java进程并不会消失。</p>
<p>这其实是由非daemon线程引起的，jvm里]]>
    </summary>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="技术" scheme="http://lawrence-zxc.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Python常见问题]]></title>
    <link href="http://lawrence-zxc.github.io/2014/05/19/python1/"/>
    <id>http://lawrence-zxc.github.io/2014/05/19/python1/</id>
    <published>2014-05-19T06:34:24.000Z</published>
    <updated>2014-10-27T08:56:04.000Z</updated>
    <content type="html"><![CDATA[<h3 id="is_和_==_的区别_与_列表的赋值问题">is 和 == 的区别 与 列表的赋值问题</h3>
<p>is 与 == 所代表的含义不同，is 表示“是”，说明里那个对象所引用的区域是相同的，而 == 表示“值相等”。两者区别可以通过下面的代码看出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span>names= [<span class="string">"Daniel"</span>,<span class="string">"Jackie"</span>]</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>n = names</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>n <span class="keyword">is</span> names</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>n == names</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>m = names[:]</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>m <span class="keyword">is</span> names</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>m == names</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>n[<span class="number">0</span>] = <span class="string">'Json'</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>n</div><div class="line">[<span class="string">'Json'</span>, <span class="string">'Jackie'</span>]</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>names</div><div class="line">[<span class="string">'Json'</span>, <span class="string">'Jackie'</span>]</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>当用 = 赋值时，names 与 n 引用同一块内存区域，所以names 与 n 是完全相同的，== 和 is 均返回True。所以改变 n[0] 会同时改变 names[0]的值，如代码最后一部分显示的一样。如果既想对列表进行改变值的操作，同时又希望保存旧版本供其他操作，这时候怎么办呢？这就需要复制整个列表的切片。如 m = names[ : ]   这样会产生一个names的副本，但是不是同一块内存区域，用 is 和 == 检查发现， is 返回 False ， == 返回 True 也可以说明这一点。</p>
<h3 id="字符串的格式化">字符串的格式化</h3>
<p>简单的字符串格式化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; format = "Hello, %s. %s enough for ya?"</div><div class="line">&gt;&gt;&gt; values = ('world', 'Hot')</div><div class="line">&gt;&gt;&gt; print format % values</div><div class="line">Hello, world. Hot enough for ya?</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>%s 为转换说明符，标记需要在此位置插入字符。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'%10.8f'</span> % pi</div><div class="line"><span class="string">'3.14159265'</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'%.5s'</span> % <span class="string">'Daniel Hou'</span></div><div class="line"><span class="string">'Danie'</span></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'%.*s'</span> % (<span class="number">5</span>, <span class="string">'Daniel Hou'</span>)</div><div class="line"><span class="string">'Danie'</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>%10.8f 10为宽度，不足时前面为空格，8为精度。 %.5s 则为从后面取出前5位，%.<em>s 中 </em>代表精度从后面的元组中读取。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span>phonebook = { <span class="string">'Hou'</span> : <span class="number">1234</span>, <span class="string">'Daniel'</span>:<span class="number">5678</span>}</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">"Hou's phone is %(Hou)s."</span> % phonebook</div><div class="line"><span class="string">"Hou's phone is 1234."</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>可以通过以上的方式来访问字典中的对应字段。括号中为字典的key     </p>
<h3 id="Python中的惰性求值">Python中的惰性求值</h3>
<p>在逻辑运算存在。例如， a and b ，当 a 为 False 时，直接返回 False ，不再运算 b； a or b，当为 a 为 True 时，直接返回 a 的值， 否则返回 b 的值。避免了代码的无用计算。运用以上的特性可以实现 java 中的三元运算符的功能。例如：a if b or c当 b 为 真时，返回 a，否则返回 c     </p>
<p>range的边界问题与xrange</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span>range(<span class="number">0</span>,<span class="number">10</span>)</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>可以看出，range不包含上界，相当于集合中的 [ a, b )xrang 函数作用类似于 range ，不同的地方在不 range 函数一次创建整个序列，而 xrange 一次只创建一个数，因此，需要迭代一个巨大的序列的时候， xrange 更加高效。</p>
<h3 id="递归">递归</h3>
<p>实现 n 的阶乘，一般实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">factorial</span><span class="params">(n)</span>:</span></div><div class="line">	result = n</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n):</div><div class="line">		result *= i</div><div class="line">	<span class="keyword">return</span> result</div><div class="line"></div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>factorial(<span class="number">10</span>)</div><div class="line"><span class="number">3628800</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>递归实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">factorial</span><span class="params">(n)</span>:</span></div><div class="line">	<span class="keyword">if</span> n == <span class="number">1</span>:</div><div class="line">		<span class="keyword">return</span> <span class="number">1</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">return</span> n*factorial(n-<span class="number">1</span>)</div><div class="line"></div><div class="line">	</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>factorial(<span class="number">10</span>)</div><div class="line"><span class="number">3628800</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>使用递归实现二分法查找（binary search）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(seq, num, lower=<span class="number">0</span>, upper=None)</span>:</span></div><div class="line">    upper = len(seq) - <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> lower == upper :</div><div class="line">        <span class="keyword">return</span> lower</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        middle = (lower + upper) // <span class="number">2</span></div><div class="line">        <span class="keyword">if</span> num &gt; seq[middle]:</div><div class="line">            <span class="keyword">return</span> search(seq, num, middle + <span class="number">1</span>, upper)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> search(seq, num, lower, middle)</div><div class="line"></div><div class="line">seq = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</div><div class="line"><span class="keyword">print</span> search(seq, <span class="number">7</span>)</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<h3 id="is_和_==_的区别_与_列表的赋值问题">is 和 == 的区别 与 列表的赋值问题</h3>
<p>is 与 == 所代表的含义不同，is 表示“是”，说明里那个对象所引用的区域是相同的，而 == 表示“值相等”。两者区别可以通过下面的代码看出来：</p>
]]>
    </summary>
    
      <category term="python" scheme="http://lawrence-zxc.github.io/tags/python/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Java Script 编码规范]]></title>
    <link href="http://lawrence-zxc.github.io/2014/05/17/javascript/"/>
    <id>http://lawrence-zxc.github.io/2014/05/17/javascript/</id>
    <published>2014-05-17T05:42:35.000Z</published>
    <updated>2014-10-27T08:55:55.000Z</updated>
    <content type="html"><![CDATA[<p>以下文档大多来自:</p>
<ul>
<li><a href="http://wyz.67ge.com/google-js/javascriptguide.xml" target="_blank" rel="external">Google JavaScript 编码规范指南</a></li>
<li><a href="https://github.com/rwldrn/idiomatic.js/tree/master/translations/zh_CN" target="_blank" rel="external">Idiomatic 风格</a></li>
</ul>
<p>参考规范</p>
<ul>
<li><a href="http://es5.github.com/" target="_blank" rel="external">ECMAScript 5.1 注解版</a></li>
<li><a href="http://ecma-international.org/ecma-262/5.1/" target="_blank" rel="external">EcmaScript 语言规范, 5.1 版</a><br>基本原则: 无论有多少人在维护，所有在代码仓库中的代码理应看起来像同一个人写的。</li>
</ul>
<h3 id="前言">前言</h3>
<p>下面的章节描述的是一个 合理 的现代 JavaScript 开发风格指南，并非硬性规定。其想送出的核心理念是高度统一的代码风格（the law of code style consistency）。你为项目所择风格都应为最高准则。作为一个描述放置于你的项目中，并链接到这个文档作为代码风格一致性、可读性和可维护性的保证。</p>
<h3 id="规范概要">规范概要</h3>
<h4 id="1-_JS/CSS_文件编码统一采用_UTF8编码">1. JS/CSS 文件编码统一采用 UTF8编码</h4>
<h4 id="2-_代码缩进使用4个空格缩进替代_tab_缩进">2. 代码缩进使用4个空格缩进替代 tab 缩进</h4>
<h4 id="3-_一行代码长度尽量保持80列左右">3. 一行代码长度尽量保持80列左右</h4>
<h4 id="4-_如果编辑器支持在文件保存的时候自动删除行末和空行中的空格(注意:要么全部采用，要么全不采用，否则会产生过多的diff信息)">4. 如果编辑器支持在文件保存的时候自动删除行末和空行中的空格(注意:要么全部采用，要么全不采用，否则会产生过多的diff信息)</h4>
<h4 id="5-_JS/CSS_最终发布到产品中的时候需要被压缩，以减小静态资源文件大小，提升页面加载速度">5. JS/CSS 最终发布到产品中的时候需要被压缩，以减小静态资源文件大小，提升页面加载速度</h4>
<h4 id="6-_JS里声明变量必须加上_var_关键字，推荐一个_var_同时声明多个变量，或者一组有逻辑关系的变量，避免一个变量一个_var-">6. JS里声明变量必须加上 var 关键字，推荐一个 var 同时声明多个变量，或者一组有逻辑关系的变量，避免一个变量一个 var.</h4>
<h4 id="7-_使用_Array_和_Object_语法直接声明并将其初始化,更易读且性能更好,_而不使用_Array_和_Object_构造器-">7. 使用 Array 和 Object 语法直接声明并将其初始化,更易读且性能更好, 而不使用 Array 和 Object 构造器.</h4>
<h4 id="8-_JS里使用单引号_(‘)_优于双引号_(“)-">8. JS里使用单引号 (‘) 优于双引号 (“).</h4>
<h4 id="9-_JS代码结尾统一约定加’;’">9. JS代码结尾统一约定加’;’</h4>
<h4 id="10-_没有特殊原因避免使用_with/eval">10. 没有特殊原因避免使用 with/eval</h4>
<h4 id="11-_对于if/else等后面的语句即使只有一行代码也需要在该行代码的首尾加上’{}’-">11. 对于if/else等后面的语句即使只有一行代码也需要在该行代码的首尾加上’{}’.</h4>
<h4 id="12-_字符串拼接在少量(次数为个位数)的情况下可以使用’+’,_大量的时候使用数组_join(),_或者尽可能采用模板引擎渲染：比如jsRender等,_如果是Extjs可以采用XTemplate-">12. 字符串拼接在少量(次数为个位数)的情况下可以使用’+’, 大量的时候使用数组 join(), 或者尽可能采用模板引擎渲染：比如jsRender等, 如果是Extjs可以采用XTemplate.</h4>
<h4 id="13-_对于数组赋值操作快于_push()操作,_所以尽量使用赋值操作-">13. 对于数组赋值操作快于 push()操作, 所以尽量使用赋值操作.</h4>
<h4 id="14-_for循环遍历：for(var_i_=_0,_l_=_arr-length;_i_&lt;_l;_i++){//_doSomething_here_}_采用这种方式而不是_i_&lt;_arr-length,_前一种方式只会计算一次_arr_的长度，而后一种方式会计算数组长度_arr-length_+_1_次，效率比较低">14. for循环遍历：for(var i = 0, l = arr.length; i &lt; l; i++){// doSomething here } 采用这种方式而不是 i &lt; arr.length, 前一种方式只会计算一次 arr 的长度，而后一种方式会计算数组长度 arr.length + 1 次，效率比较低</h4>
<h4 id="15-_字符串转换为整数，推荐使用_parseInt(num,_10)_这种方式，+num_写法简单，在操作次数极少的情况下也可以酌情使用。">15. 字符串转换为整数，推荐使用 parseInt(num, 10) 这种方式，+num 写法简单，在操作次数极少的情况下也可以酌情使用。</h4>
<h4 id="16-_变量比较的时候总是判断最好、最精确的值，推荐使用’===’少用’==’(可以参考jQuery代码里面,_可以看到只有在’==_null’的时候才可能使用’==’，其他情况一律使用的是’===’)-">16. 变量比较的时候总是判断最好、最精确的值，推荐使用’===’少用’==’(可以参考jQuery代码里面, 可以看到只有在’== null’的时候才可能使用’==’，其他情况一律使用的是’===’).</h4>
<h4 id="17-_JS里变量命名规范使用_functionNamesLikeThis,_variableNamesLikeThis,_ClassNamesLikeThis,_EnumNamesLikeThis,_methodNamesLikeThis,_和_SYMBOLIC_CONSTANTS_LIKE_THIS,_尤其不要跟python里面的变量命名方式混淆了-">17. JS里变量命名规范使用 functionNamesLikeThis, variableNamesLikeThis, ClassNamesLikeThis, EnumNamesLikeThis, methodNamesLikeThis, 和 SYMBOLIC_CONSTANTS_LIKE_THIS, 尤其不要跟python里面的变量命名方式混淆了.</h4>
<h4 id="18-_JS文件名应该使用小写字符,_以避免在有些系统平台上不识别大小写的命名方式-_文件名以-js结尾,_不要包含除_‘-‘_和_‘‘_外的标点符号(使用_‘-‘_优于_‘‘),_我们约定统一使用js-file-name-js这种类型，对于template文件命名方式为_template_name-html形式-">18. JS文件名应该使用小写字符, 以避免在有些系统平台上不识别大小写的命名方式. 文件名以.js结尾, 不要包含除 ‘-‘ 和 ‘‘ 外的标点符号(使用 ‘-‘ 优于 ‘‘), 我们约定统一使用js-file-name.js这种类型，对于template文件命名方式为 template_name.html形式.</h4>
<h4 id="19-_所有的html_DOM里面的id,_Extjs配置项里面的id_以及所有样式里面的_class命名使用中划线，如’id-name’/‘class-name’-">19. 所有的html DOM里面的id, Extjs配置项里面的id 以及所有样式里面的 class命名使用中划线，如’id-name’/‘class-name’.</h4>
<h4 id="20-公共的js第三方类库放在static/js/common/lib下，jQuery相关类库放在static/js/common/lib/jQplugin下，我们自己开发的公共类库放在static/js/common下">20.公共的js第三方类库放在static/js/common/lib下，jQuery相关类库放在static/js/common/lib/jQplugin下，我们自己开发的公共类库放在static/js/common下</h4>
<h4 id="21-_鉴于有很多代码是复制粘贴过来的，所以大家要保证自己的代码风格良好且易于阅读，不然别人拷过去后不好的风格就蔓延开了，而且会导致其他人效仿。">21. 鉴于有很多代码是复制粘贴过来的，所以大家要保证自己的代码风格良好且易于阅读，不然别人拷过去后不好的风格就蔓延开了，而且会导致其他人效仿。</h4>
<h4 id="22-_对于复制粘贴然后做相应修改以实现功能的代码，请务必清理干净，不要有’忘了删除的不影响逻辑的代码’，同时记得将变量名改成适合当前业务场景的有意义的变量名,_不要因为不影响逻辑就保留原来的不适合当前场景的名字">22. 对于复制粘贴然后做相应修改以实现功能的代码，请务必清理干净，不要有’忘了删除的不影响逻辑的代码’，同时记得将变量名改成适合当前业务场景的有意义的变量名, 不要因为不影响逻辑就保留原来的不适合当前场景的名字</h4>
<h4 id="23-_对于系统中出现的大段注释的、过时的、废弃的代码务必及时清理干净，谁制造谁清理，否则其他人也不敢清理，越积越多">23. 对于系统中出现的大段注释的、过时的、废弃的代码务必及时清理干净，谁制造谁清理，否则其他人也不敢清理，越积越多</h4>
<h4 id="24-_不要使用魔法数字，尽量定义一个常量来表示该数字，并加上相应的注释，否则后期可能出现因为数字变化而导致牵一发而动全身，需要到处修改，增加维护成本">24. 不要使用魔法数字，尽量定义一个常量来表示该数字，并加上相应的注释，否则后期可能出现因为数字变化而导致牵一发而动全身，需要到处修改，增加维护成本</h4>
<h4 id="25-_注释尽量采用jsdoc的代码注释风格，普通业务代码不做要求，不过通用js类库要求尽量详尽以方便其他人阅读使用">25. 注释尽量采用jsdoc的代码注释风格，普通业务代码不做要求，不过通用js类库要求尽量详尽以方便其他人阅读使用</h4>
<h4 id="26-_在开发相应功能的时候尽量抽象化、组件化、通用化：考虑这个东西其他地方会不会用到，能不能做成一个组件？而不是类似的代码到处复制、修改或者让大家都去写一遍">26. 在开发相应功能的时候尽量抽象化、组件化、通用化：考虑这个东西其他地方会不会用到，能不能做成一个组件？而不是类似的代码到处复制、修改或者让大家都去写一遍</h4>
<h4 id="27-_类似地，在解决问题的时候要考虑下其他地方会不会存在同样的问题？能不能统一解决掉？尤其对于类似ExtJs的Bug这种，能不能做最少的改动解决所有同样的问题,类似于全局补丁-">27. 类似地，在解决问题的时候要考虑下其他地方会不会存在同样的问题？能不能统一解决掉？尤其对于类似ExtJs的Bug这种，能不能做最少的改动解决所有同样的问题,类似于全局补丁.</h4>
<h4 id="28-_代码风格跟其他JS文件的代码风格保持一致">28. 代码风格跟其他JS文件的代码风格保持一致</h4>
<h4 id="29-_新增、修改、查看等表单在_popup的时候需要重新初始化清除原来数据">29. 新增、修改、查看等表单在 popup的时候需要重新初始化清除原来数据</h4>
<h4 id="30-_代码提交前用JSHint检查一下">30. 代码提交前用JSHint检查一下</h4>
<h3 id="前端资源Build">前端资源Build</h3>
<p>项目必须总是提供一些通用的方法来检验（can be linted）、测试和压缩源码以为产品阶段使用做准备。对于此类工作 Ben Alman 所写的 <a href="https://github.com/cowboy/grunt" target="_blank" rel="external">grunt</a> 可谓首屈一指。通过简单的配置即可完成自动对CSS进行检查/压缩/合并，对JS进行检查/压缩/合并，对html文件进行压缩，删除创建目录，拷贝文件，压缩打包等，十分方便。</p>
<p>参考的grunt配置文件:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Grunt file for front end resource check/minify/compress.</div><div class="line"> */</div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> </span>{</div><div class="line">  grunt.initConfig({</div><div class="line">    pkg: grunt.file.readJSON(<span class="string">'package.json'</span>),</div><div class="line">    jshint: {</div><div class="line">      options: {</div><div class="line">        asi       : <span class="literal">true</span>,</div><div class="line">        curly     : <span class="literal">false</span>,</div><div class="line">        eqeqeq    : <span class="literal">true</span>,</div><div class="line">        immed     : <span class="literal">false</span>,</div><div class="line">        latedef   : <span class="literal">true</span>,</div><div class="line">        newcap    : <span class="literal">true</span>,</div><div class="line">        noarg     : <span class="literal">true</span>,</div><div class="line">        sub       : <span class="literal">true</span>,</div><div class="line">        undef     : <span class="literal">true</span>,</div><div class="line">        boss      : <span class="literal">true</span>,</div><div class="line">        eqnull    : <span class="literal">true</span>,</div><div class="line">        smarttabs : <span class="literal">true</span>,</div><div class="line">        browser   : <span class="literal">true</span>,</div><div class="line">        jquery    : <span class="literal">true</span>,</div><div class="line">        white     : <span class="literal">false</span>,</div><div class="line">        laxbreak  : <span class="literal">false</span>,</div><div class="line">        laxcomma  : <span class="literal">true</span>,</div><div class="line">        expr      : <span class="literal">true</span>,</div><div class="line">        devel     : <span class="literal">false</span>,</div><div class="line">        globals   : {</div><div class="line">          <span class="built_in">module</span>    : <span class="literal">true</span>,</div><div class="line">          Mousetrap : <span class="literal">true</span>,</div><div class="line">          jQuery    : <span class="literal">true</span></div><div class="line">        }</div><div class="line">      },</div><div class="line">      all: [<span class="string">'Gruntfile.js'</span>, <span class="string">'js/**/*.js'</span>, <span class="string">'!js/**/*.min.js'</span>, <span class="string">'!js/json2.js'</span>, <span class="string">'!js/jquery.simplemodal.js'</span>]</div><div class="line">    },</div><div class="line">    clean: {</div><div class="line">      release: {</div><div class="line">        src: [<span class="string">'release/'</span>]</div><div class="line">      }</div><div class="line">    },</div><div class="line">    uglify: {</div><div class="line">      options: {</div><div class="line">        banner: <span class="string">'/*! &lt;%= pkg.description %&gt;  Ver: &lt;%= pkg.version %&gt;  Date: &lt;%= grunt.template.today("yyyy/mm/dd HH:MM:ss") %&gt; */\n'</span></div><div class="line">      },</div><div class="line">      dist: {</div><div class="line">        <span class="comment">// Grunt will search for "**/?.js" under "js/" when the "uglify" task</span></div><div class="line">        <span class="comment">// runs and build the appropriate src-dest file mappings then, so you</span></div><div class="line">        <span class="comment">// don't need to update the Gruntfile when files are added or removed.</span></div><div class="line">        files: [</div><div class="line">          {</div><div class="line">            expand : <span class="literal">true</span>,                                  <span class="comment">// Enable dynamic expansion.</span></div><div class="line">            cwd    : <span class="string">'js/'</span>,                                 <span class="comment">// Src matches are relative to this path.</span></div><div class="line">            src    : [<span class="string">'jquery.simplemodal.js'</span>,<span class="string">'index.js'</span>],  <span class="comment">// Actual pattern(s) to match.</span></div><div class="line">            dest   : <span class="string">'release/js/'</span>                          <span class="comment">// Destination path prefix.</span></div><div class="line">            <span class="comment">// ext : '.js'                                  // Dest filepaths will have this extension. '.min.js' is recommeded.</span></div><div class="line">          }</div><div class="line">        ]</div><div class="line">      }</div><div class="line">    },</div><div class="line">    cssmin: {</div><div class="line">      minify: {</div><div class="line">        expand : <span class="literal">true</span>,</div><div class="line">        cwd    : <span class="string">'style/'</span>,</div><div class="line">        src    : [<span class="string">'*.css'</span>],</div><div class="line">        dest   : <span class="string">'release/style/'</span>,</div><div class="line">        ext    : <span class="string">'.css'</span></div><div class="line">      }</div><div class="line">    },</div><div class="line">    htmlmin: {                                     <span class="comment">// Task</span></div><div class="line">      dist: {                                      <span class="comment">// Target</span></div><div class="line">        options: {                                 <span class="comment">// Target options</span></div><div class="line">          removeComments: <span class="literal">true</span>,</div><div class="line">          collapseWhitespace: <span class="literal">true</span></div><div class="line">        },</div><div class="line">        files: {                                   <span class="comment">// Dictionary of files</span></div><div class="line">          <span class="string">'release/index.html'</span>: <span class="string">'index.html'</span>       <span class="comment">// 'destination': 'source'</span></div><div class="line">        }</div><div class="line">      }</div><div class="line">    },</div><div class="line">    copy: {</div><div class="line">      main: {</div><div class="line">        files: [</div><div class="line">          {expand: <span class="literal">true</span>, cwd: <span class="string">'.'</span>, src: [<span class="string">'js/*.min.js'</span>, <span class="string">'js/json2.js'</span>, <span class="string">'images/*'</span>], dest: <span class="string">'release/'</span>}</div><div class="line">        ]</div><div class="line">      }</div><div class="line">    },</div><div class="line">    compress: {</div><div class="line">      main: {</div><div class="line">        options: {</div><div class="line">          archive: <span class="string">'release/executable.zip'</span>         <span class="comment">// make a zipfile</span></div><div class="line">        },</div><div class="line">        files: [</div><div class="line">          <span class="comment">// {src: ['release/**'], dest: 'release/'},                        // includes files in path and its subdirs</span></div><div class="line">          {expand: <span class="literal">true</span>, cwd: <span class="string">'release/'</span>, src: [<span class="string">'**'</span>], dest: <span class="string">'executable/'</span>}  <span class="comment">// makes all src relative to cwd</span></div><div class="line">        ]</div><div class="line">      }</div><div class="line">    }</div><div class="line">  });</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-jshint'</span>);</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-clean'</span>);</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-uglify'</span>);</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-cssmin'</span>);</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-htmlmin'</span>);</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-copy'</span>);</div><div class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-compress'</span>);</div><div class="line">  grunt.registerTask(<span class="string">'min'</span>    , [<span class="string">'clean'</span>, <span class="string">'uglify'</span>, <span class="string">'cssmin'</span>, <span class="string">'htmlmin'</span>, <span class="string">'copy'</span>, <span class="string">'compress'</span>]);</div><div class="line">  grunt.registerTask(<span class="string">'check'</span>  , [<span class="string">'jshint'</span>]);</div><div class="line">  grunt.registerTask(<span class="string">'default'</span>, [<span class="string">'jshint'</span>, <span class="string">'clean'</span>, <span class="string">'uglify'</span>, <span class="string">'cssmin'</span>, <span class="string">'htmlmin'</span>, <span class="string">'copy'</span>, <span class="string">'compress'</span>]);</div><div class="line">};</div></pre></td></tr></table></figure>

<h3 id="规范详情">规范详情</h3>
<p>JavaScript 编码风格</p>
<p>空白<br><em>永远都不要混用空格和Tab。
</em>开始一个项目，在写代码之前，选择软缩进（空格）或者 Tab（作为缩进方式），并将其作为最高准则。<br>    <em>为了可读, 我总是推荐在你的编辑中设计4个字母宽度的缩进 — 这等同于四个空格或者四个空格替代一个 Tab。
</em>如果你的编辑器支持，请总是打开 “显示不可见字符” 这个设置。好处是：<br>    <em>保证一致性
    </em>去掉行末的空格<br>    <em>去掉空行的空格
    </em>提交和对比更具可读性</p>
<p>行末和空行<br>留白会破坏 diff 并使diff 结果变得更不可读。考虑包括一个预提交的 hook 自动删除行末和空行中的空格。<br>花括号, 换行</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// if/else/for/while/try 通常都有小括号、花括号和多行</span></div><div class="line"><span class="comment">// 这有助于可读, 以下是很糟糕的写法</span></div><div class="line"><span class="keyword">if</span>(condition) doSomething();</div><div class="line"><span class="keyword">while</span>(condition) iterating++;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++) someIterativeFn();</div></pre></td></tr></table></figure>

<p>命名</p>
<p>通常, 使用 functionNamesLikeThis, variableNamesLikeThis, ClassNamesLikeThis, EnumNamesLikeThis, methodNamesLikeThis, 和 SYMBOLIC_CONSTANTS_LIKE_THIS.</p>
<p>属性和方法</p>
<p>文件或类中的 私有 属性, 变量和方法名应该以下划线 “_” 开头.<br>保护 属性, 变量和方法名不需要下划线开头, 和公共变量名一样.</p>
<p>方法和函数参数</p>
<p>可选参数以 opt_ 开头.<br>函数的参数个数不固定时, 应该添加最后一个参数 var_args 为参数的个数. 你也可以不设置 var_args而取代使用 arguments.<br>可选和可变参数应该在 @param 标记中说明清楚. 虽然这两个规定对编译器没有任何影响, 但还是请尽量遵守<br>Getters 和 Setters<br>Getters 和 setters 并不是必要的. 但只要使用它们了, 就请将 getters 命名成 getFoo() 形式, 将 setters 命名成 setFoo(value) 形式. (对于布尔类型的 getters, 使用 isFoo() 也可.)</p>
<p>命名空间</p>
<p>JavaScript 不支持包和命名空间.<br>不容易发现和调试全局命名的冲突, 多个系统集成时还可能因为命名冲突导致很严重的问题. 为了提高 JavaScript 代码复用率, 我们遵循下面的约定以避免冲突.<br>为全局代码使用命名空间<br>在全局作用域上, 使用一个唯一的, 与工程/库相关的名字作为前缀标识. 比如, 你的工程是 “Project Sloth”, 那么命名空间前缀可取为 sloth.*.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sloth = {};</div><div class="line">sloth.sleep = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  ...</div><div class="line">};</div></pre></td></tr></table></figure>

<p>许多 JavaScript 库, 包括 the Closure Library and Dojo toolkit 为你提供了声明你自己的命名空间的函数. 比如:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">goog.provide(<span class="string">'sloth'</span>);</div><div class="line">sloth.sleep = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  ...</div><div class="line">};</div></pre></td></tr></table></figure>

<p>明确命名空间所有权<br>当选择了一个子命名空间, 请确保父命名空间的负责人知道你在用哪个子命名空间, 比如说, 你为工程 ‘sloths’ 创建一个 ‘hats’ 子命名空间, 那确保 Sloth 团队人员知道你在使用 sloth.hats.<br>外部代码和内部代码使用不同的命名空间<br>“外部代码” 是指来自于你代码体系的外部, 可以独立编译. 内外部命名应该严格保持独立. 如果你使用了外部库, 他的所有对象都在 foo.hats. 下, 那么你自己的代码不能在 foo.hats.下命名, 因为很有可能其他团队也在其中命名.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">foo.require(<span class="string">'foo.hats'</span>);</div><div class="line"><span class="comment">/**</span></div><div class="line"> * WRONG -- Do NOT do this.</div><div class="line"> * @constructor</div><div class="line"> * @extend {foo.hats.RoundHat}</div><div class="line"> */</div><div class="line">foo.hats.BowlerHat = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">};</div></pre></td></tr></table></figure>

<p>重命名那些名字很长的变量, 提高可读性<br>主要是为了提高可读性. 局部空间中的变量别名只需要取原名字的最后部分.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * @constructor</div><div class="line"> */</div><div class="line">some.long.namespace.MyClass = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">};</div><div class="line"><span class="comment">/**</span></div><div class="line"> * @param {some.long.namespace.MyClass} a</div><div class="line"> */</div><div class="line">some.long.namespace.MyClass.staticHelper = <span class="function"><span class="keyword">function</span><span class="params">(a)</span> </span>{</div><div class="line">  ...</div><div class="line">};</div><div class="line">myapp.main = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">var</span> MyClass = some.long.namespace.MyClass;</div><div class="line">  <span class="keyword">var</span> staticHelper = some.long.namespace.MyClass.staticHelper;</div><div class="line">  staticHelper(<span class="keyword">new</span> MyClass());</div><div class="line">};</div></pre></td></tr></table></figure>

<p>除非是枚举类型, 不然不要访问别名变量的属性.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** @enum {string} */</span></div><div class="line">some.long.namespace.Fruit = {</div><div class="line">  APPLE: <span class="string">'a'</span>,</div><div class="line">  BANANA: <span class="string">'b'</span></div><div class="line">};</div><div class="line">myapp.main = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">var</span> Fruit = some.long.namespace.Fruit;</div><div class="line">  <span class="keyword">switch</span> (fruit) {</div><div class="line">    <span class="keyword">case</span> Fruit.APPLE:</div><div class="line">      ...</div><div class="line">    <span class="keyword">case</span> Fruit.BANANA:</div><div class="line">      ...</div><div class="line">  }</div><div class="line">};</div><div class="line">myapp.main = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">var</span> MyClass = some.long.namespace.MyClass;</div><div class="line">  MyClass.staticHelper(<span class="literal">null</span>);</div><div class="line">};</div></pre></td></tr></table></figure>

<p>不要在全局范围内创建别名, 而仅在函数块作用域中使用.<br>文件名<br>文件名应该使用小写字符, 以避免在有些系统平台上不识别大小写的命名方式. 文件名以.js结尾, 不要包含除 - 和 外的标点符号(使用 - 优于 ).<br>自定义 toString() 方法<br>应该总是成功调用且不要抛异常.<br>可自定义 toString() 方法, 但确保你的实现方法满足: (1) 总是成功 (2) 没有其他负面影响. 如果不满足这两个条件, 那么可能会导致严重的问题, 比如, 如果 toString() 调用了包含 assert 的函数, assert 输出导致失败的对象, 这在 toString() 也会被调用.<br>延迟初始化<br>可以<br>没必要在每次声明变量时就将其初始化.<br>明确作用域<br>任何时候都需要<br>任何时候都要明确作用域 - 提高可移植性和清晰度. 例如, 不要依赖于作用域链中的 window 对象. 可能在其他应用中, 你函数中的 window 不是指之前的那个窗口对象.<br>代码格式化<br>大括号<br>分号会被隐式插入到代码中, 所以你务必在同一行上插入大括号. 例如:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (something) {</div><div class="line">  <span class="comment">// ...</span></div><div class="line">} <span class="keyword">else</span> {</div><div class="line">  <span class="comment">// ...</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>数组和对象的初始化<br>如果初始值不是很长, 就保持写在单行上:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];  <span class="comment">// No space after [ or before ].</span></div><div class="line"><span class="keyword">var</span> obj = {a: <span class="number">1</span>, b: <span class="number">2</span>, c: <span class="number">3</span>};  <span class="comment">// No space after { or before }.</span></div></pre></td></tr></table></figure>

<p>初始值占用多行时, 缩进2个空格.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Object initializer.</span></div><div class="line"><span class="keyword">var</span> inset = {</div><div class="line">  top: <span class="number">10</span>,</div><div class="line">  right: <span class="number">20</span>,</div><div class="line">  bottom: <span class="number">15</span>,</div><div class="line">  left: <span class="number">12</span></div><div class="line">};</div><div class="line"><span class="comment">// Array initializer.</span></div><div class="line"><span class="keyword">this</span>.rows_ = [</div><div class="line">  <span class="string">'"Slartibartfast" &lt;fjordmaster@magrathea.com&gt;'</span>,</div><div class="line">  <span class="string">'"Zaphod Beeblebrox" &lt;theprez@universe.gov&gt;'</span>,</div><div class="line">  <span class="string">'"Ford Prefect" &lt;ford@theguide.com&gt;'</span>,</div><div class="line">  <span class="string">'"Arthur Dent" &lt;has.no.tea@gmail.com&gt;'</span>,</div><div class="line">  <span class="string">'"Marvin the Paranoid Android" &lt;marv@googlemail.com&gt;'</span>,</div><div class="line">  <span class="string">'the.mice@magrathea.com'</span></div><div class="line">];</div><div class="line"><span class="comment">// Used in a method call.</span></div><div class="line">goog.dom.createDom(goog.dom.TagName.DIV, {</div><div class="line">  id: <span class="string">'foo'</span>,</div><div class="line">  className: <span class="string">'some-css-class'</span>,</div><div class="line">  style: <span class="string">'display:none'</span></div><div class="line">}, <span class="string">'Hello, world!'</span>);</div></pre></td></tr></table></figure>

<p>函数参数<br>尽量让函数参数在同一行上. 如果一行超过 80 字符, 每个参数独占一行, 并以4个空格缩进, 或者与括号对齐, 以提高可读性. 尽可能不要让每行超过80个字符. 比如下面这样:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Four-space, wrap at 80.  Works with very long function names, survives</span></div><div class="line"><span class="comment">// renaming without reindenting, low on space.</span></div><div class="line">goog.foo.bar.doThingThatIsVeryDifficultToExplain = <span class="function"><span class="keyword">function</span><span class="params">(</span></span></div><div class="line">    veryDescriptiveArgumentNumberOne, veryDescriptiveArgumentTwo,</div><div class="line">    tableModelEventHandlerProxy, artichokeDescriptorAdapterIterator) {</div><div class="line">  <span class="comment">// ...</span></div><div class="line">};</div><div class="line"><span class="comment">// Four-space, one argument per line.  Works with long function names,</span></div><div class="line"><span class="comment">// survives renaming, and emphasizes each argument.</span></div><div class="line">goog.foo.bar.doThingThatIsVeryDifficultToExplain = <span class="function"><span class="keyword">function</span><span class="params">(</span></span></div><div class="line">    veryDescriptiveArgumentNumberOne,</div><div class="line">    veryDescriptiveArgumentTwo,</div><div class="line">    tableModelEventHandlerProxy,</div><div class="line">    artichokeDescriptorAdapterIterator) {</div><div class="line">  <span class="comment">// ...</span></div><div class="line">};</div><div class="line"><span class="comment">// Parenthesis-aligned indentation, wrap at 80.  Visually groups arguments,</span></div><div class="line"><span class="comment">// low on space.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(veryDescriptiveArgumentNumberOne, veryDescriptiveArgumentTwo,</span></span></div><div class="line">             tableModelEventHandlerProxy, artichokeDescriptorAdapterIterator) {</div><div class="line">  <span class="comment">// ...</span></div><div class="line">}</div><div class="line"><span class="comment">// Parenthesis-aligned, one argument per line.  Visually groups and</span></div><div class="line"><span class="comment">// emphasizes each individual argument.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">(veryDescriptiveArgumentNumberOne,</span></span></div><div class="line">             veryDescriptiveArgumentTwo,</div><div class="line">             tableModelEventHandlerProxy,</div><div class="line">             artichokeDescriptorAdapterIterator) {</div><div class="line">  <span class="comment">// ...</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>传递匿名函数<br>如果参数中有匿名函数, 函数体从调用该函数的左边开始缩进2个空格, 而不是从 function 这个关键字开始. 这让匿名函数更加易读 (不要增加很多没必要的缩进让函数体显示在屏幕的右侧).</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> names = items.map(<span class="function"><span class="keyword">function</span><span class="params">(item)</span> </span>{</div><div class="line">                        <span class="keyword">return</span> item.name;</div><div class="line">                      });</div><div class="line">prefix.something.reallyLongFunctionName(<span class="string">'whatever'</span>, <span class="function"><span class="keyword">function</span><span class="params">(a1, a2)</span> </span>{</div><div class="line">  <span class="keyword">if</span> (a1.equals(a2)) {</div><div class="line">    someOtherLongFunctionName(a1);</div><div class="line">  } <span class="keyword">else</span> {</div><div class="line">    andNowForSomethingCompletelyDifferent(a2.parrot);</div><div class="line">  }</div><div class="line">});</div></pre></td></tr></table></figure>

<p>更多的缩进<br>事实上, 除了 初始化数组和对象 , 和传递匿名函数外, 所有被拆开的多行文本要么选择与之前的表达式左对齐, 要么以4个(而不是2个)空格作为一缩进层次.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">someWonderfulHtml = <span class="string">''</span> +</div><div class="line">                    getEvenMoreHtml(someReallyInterestingValues, moreValues,</div><div class="line">                                    evenMoreParams, <span class="string">'a duck'</span>, <span class="literal">true</span>, <span class="number">72</span>,</div><div class="line">                                    slightlyMoreMonkeys(<span class="number">0xfff</span>)) +</div><div class="line">                    <span class="string">''</span>;</div><div class="line">thisIsAVeryLongVariableName =</div><div class="line">    hereIsAnEvenLongerOtherFunctionNameThatWillNotFitOnPrevLine();</div><div class="line">thisIsAVeryLongVariableName = <span class="string">'expressionPartOne'</span> + someMethodThatIsLong() +</div><div class="line">    thisIsAnEvenLongerOtherFunctionNameThatCannotBeIndentedMore();</div><div class="line">someValue = <span class="keyword">this</span>.foo(</div><div class="line">    shortArg,</div><div class="line">    <span class="string">'Some really long string arg - this is a pretty common case, actually.'</span>,</div><div class="line">    shorty2,</div><div class="line">    <span class="keyword">this</span>.bar());</div><div class="line"><span class="keyword">if</span> (searchableCollection(allYourStuff).contains(theStuffYouWant) &&</div><div class="line">    !ambientNotification.isActive() && (client.isAmbientSupported() ||</div><div class="line">                                        client.alwaysTryAmbientAnyways()) {</div><div class="line">  ambientNotification.activate();</div><div class="line">}</div></pre></td></tr></table></figure>

<p>空行<br>使用空行来划分一组逻辑上相关联的代码片段.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">doSomethingTo(x);</div><div class="line">doSomethingElseTo(x);</div><div class="line">andThen(x);</div><div class="line">nowDoSomethingWith(y);</div><div class="line">andNowWith(z);</div></pre></td></tr></table></figure>

<h3 id="二元和三元操作符">二元和三元操作符</h3>
<p>操作符始终跟随着前行, 这样就不用顾虑分号的隐式插入问题. 如果一行实在放不下, 还是按照上述的缩进风格来换行.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = a ? b : c;  <span class="comment">// All on one line if it will fit.</span></div><div class="line"><span class="comment">// Indentation +4 is OK.</span></div><div class="line"><span class="keyword">var</span> y = a ?</div><div class="line">    longButSimpleOperandB : longButSimpleOperandC;</div><div class="line"><span class="comment">// Indenting to the line position of the first operand is also OK.</span></div><div class="line"><span class="keyword">var</span> z = a ?</div><div class="line">        moreComplicatedB :</div><div class="line">        moreComplicatedC;</div></pre></td></tr></table></figure>

<p>括号<br>只在需要的时候使用<br>不要滥用括号, 只在必要的时候使用它.<br>对于一元操作符(如delete, typeof 和 void ), 或是在某些关键词(如 return, throw, case, new )之后, 不要使用括号.<br>字符串<br>使用 ‘ 优于 “<br>无论你选择单引号还是双引号都无所谓，在 JavaScript 中它们在解析上没有区别。而绝对需要强制的是一致性。 永远不要在同一个项目中混用两种引号，选择一种，并保持一致。<br>单引号 (‘) 优于双引号 (“). 当你创建一个包含 HTML 代码的字符串时就知道它的好处了.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> msg = <span class="string">'This is some HTML'</span>;</div></pre></td></tr></table></figure>

<p>前置逗号（Comma First）<br>请勿使用。所有使用这个文档作为基本风格指南的项目都不允许前置逗号的代码格式，除非明确指定或者作者要求。<br>注释<br>单行注释放于代码上方为首选<br>多行也可以<br>行末注释应被避免!<br>JSDoc 的方式也不错，但需要比较多的时间<br>使用 JSDoc<br>我们使用 JSDoc 中的注释风格. 行内注释使用 // 变量 的形式. 另外, 我们也遵循 C++ 代码注释风格 . 这也就是说你需要:<br>版权和著作权的信息,<br>文件注释中应该写明该文件的基本信息(如, 这段代码的功能摘要, 如何使用, 与哪些东西相关), 来告诉那些不熟悉代码的读者.<br>类, 函数, 变量和必要的注释,<br>期望在哪些浏览器中执行,<br>正确的大小写, 标点和拼写.<br>为了避免出现句子片段, 请以合适的大/小写单词开头, 并以合适的标点符号结束这个句子.<br>现在假设维护这段代码的是一位初学者. 这可能正好是这样的!<br>目前很多编译器可从 JSDoc 中提取类型信息, 来对代码进行验证, 删除和压缩. 因此, 你很有必要去熟悉正确完整的 JSDoc .<br>顶层/文件注释<br>顶层注释用于告诉不熟悉这段代码的读者这个文件中包含哪些东西. 应该提供文件的大体内容, 它的作者, 依赖关系和兼容性信息. 如下:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Copyright 2009 Google Inc. All Rights Reserved.</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * @fileoverview Description of file, its uses and information</div><div class="line"> * about its dependencies.</div><div class="line"> * @author user@google.com (Firstname Lastname)</div><div class="line"> */</div></pre></td></tr></table></figure>

<p>类注释<br>每个类的定义都要附带一份注释, 描述类的功能和用法. 也需要说明构造器参数. 如果该类继承自其它类, 应该使用 @extends 标记. 如果该类是对接口的实现, 应该使用 @implements 标记.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Class making something fun and easy.</div><div class="line"> * @param {string} arg1 An argument that makes this more interesting.</div><div class="line"> * @param {Array.&lt;number&gt;} arg2 List of numbers to be processed.</div><div class="line"> * @constructor</div><div class="line"> * @extends {goog.Disposable}</div><div class="line"> */</div><div class="line">project.MyClass = <span class="function"><span class="keyword">function</span><span class="params">(arg1, arg2)</span> </span>{</div><div class="line">  <span class="comment">// ...</span></div><div class="line">};</div><div class="line">goog.inherits(project.MyClass, goog.Disposable);</div></pre></td></tr></table></figure>

<p>方法与函数的注释<br>提供参数的说明. 使用完整的句子, 并用第三人称来书写方法说明.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Converts text to some completely different text.</div><div class="line"> * @param {string} arg1 An argument that makes this more interesting.</div><div class="line"> * @return {string} Some return value.</div><div class="line"> */</div><div class="line">project.MyClass.prototype.someMethod = <span class="function"><span class="keyword">function</span><span class="params">(arg1)</span> </span>{</div><div class="line">  <span class="comment">// ...</span></div><div class="line">};</div><div class="line"><span class="comment">/**</span></div><div class="line"> * Operates on an instance of MyClass and returns something.</div><div class="line"> * @param {project.MyClass} obj Instance of MyClass which leads to a long</div><div class="line"> *     comment that needs to be wrapped to two lines.</div><div class="line"> * @return {boolean} Whether something occured.</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PR_someMethod</span><span class="params">(obj)</span> </span>{</div><div class="line">  <span class="comment">// ...</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>对于一些简单的, 不带参数的 getters, 说明可以忽略.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * @return {Element} The element for the component.</div><div class="line"> */</div><div class="line">goog.ui.Component.prototype.getElement = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.element_;</div><div class="line">};</div></pre></td></tr></table></figure>

<p>属性注释<br>也需要对属性进行注释.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Maximum number of things per pane.</div><div class="line"> * @type {number}</div><div class="line"> */</div><div class="line">project.MyClass.prototype.someProperty = <span class="number">4</span>;</div></pre></td></tr></table></figure>

<p>JSDoc 缩进<br>如果你在 @param, @return, @supported, @this 或 @deprecated 中断行, 需要像在代码中一样, 使用4个空格作为一个缩进层次.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Illustrates line wrapping for long param/return descriptions.</div><div class="line"> * @param {string} foo This is a param with a description too long to fit in</div><div class="line"> *     one line.</div><div class="line"> * @return {number} This returns something that has a description too long to</div><div class="line"> *     fit in one line.</div><div class="line"> */</div><div class="line">project.MyClass.prototype.method = <span class="function"><span class="keyword">function</span><span class="params">(foo)</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="number">5</span>;</div><div class="line">};</div></pre></td></tr></table></figure>

<p>不要在 @fileoverview 标记中进行缩进.<br>虽然不建议, 但也可对说明文字进行适当的排版对齐. 不过, 这样带来一些负面影响, 就是当你每次修改变量名时, 都得重新排版说明文字以保持和变量名对齐.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * This is NOT the preferred indentation method.</div><div class="line"> * @param {string} foo This is a param with a description too long to fit in</div><div class="line"> *                     one line.</div><div class="line"> * @return {number} This returns something that has a description too long to</div><div class="line"> *                  fit in one line.</div><div class="line"> */</div><div class="line">project.MyClass.prototype.method = <span class="function"><span class="keyword">function</span><span class="params">(foo)</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="number">5</span>;</div><div class="line">};</div></pre></td></tr></table></figure>

<p>枚举</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Enum for tri-state values.</div><div class="line"> * @enum {number}</div><div class="line"> */</div><div class="line">project.TriState = {</div><div class="line">  TRUE: <span class="number">1</span>,</div><div class="line">  FALSE: -<span class="number">1</span>,</div><div class="line">  MAYBE: <span class="number">0</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>注意一下, 枚举也具有有效类型, 所以可以当成参数类型来用.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Sets project state.</div><div class="line"> * @param {project.TriState} state New project state.</div><div class="line"> */</div><div class="line">project.setState = <span class="function"><span class="keyword">function</span><span class="params">(state)</span> </span>{</div><div class="line">  <span class="comment">// ...</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>JavaScript 语言规范<br>变量<br>声明变量必须加上 var 关键字.<br>当你没有写 var, 变量就会暴露在全局上下文中, 这样很可能会和现有变量冲突. 另外, 如果没有加上, 很难明确该变量的作用域是什么, 变量也很可能像在局部作用域中, 很轻易地泄漏到 Document 或者 Window 中, 所以务必用 var 去声明变量.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 变量</span></div><div class="line"><span class="keyword">var</span> foo = <span class="string">"bar"</span>,</div><div class="line">  num = <span class="number">1</span>,</div><div class="line">  undef;</div><div class="line"><span class="comment">// 字面量标识:</span></div><div class="line"><span class="keyword">var</span> array = [],</div><div class="line">  object = {};</div><div class="line"><span class="comment">// 在一个作用域（函数）内只使用一个 `var` 有助于提升可读性</span></div><div class="line"><span class="comment">// 并且让你的声明列表变得有条不紊 (还帮你省了几次键盘敲击)</span></div><div class="line"><span class="comment">// 不好</span></div><div class="line"><span class="keyword">var</span> foo = <span class="string">""</span>;</div><div class="line"><span class="keyword">var</span> bar = <span class="string">""</span>;</div><div class="line"><span class="keyword">var</span> qux;</div><div class="line"><span class="comment">// 好的做法</span></div><div class="line"><span class="keyword">var</span> foo = <span class="string">""</span>,</div><div class="line">  bar = <span class="string">""</span>,</div><div class="line">  quux;</div><div class="line"><span class="comment">// 或者..</span></div><div class="line"><span class="keyword">var</span> <span class="comment">// 对这些变量的注释</span></div><div class="line">foo = <span class="string">""</span>,</div><div class="line">bar = <span class="string">""</span>,</div><div class="line">quux;</div><div class="line"><span class="comment">// `var` 语句必须总是在各自作用域（函数）顶部</span></div><div class="line"><span class="comment">// 同样适应于来自 ECMAScript 6 的常量</span></div><div class="line"><span class="comment">// 不好</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>{</div><div class="line">  <span class="comment">// 在变量前有语句</span></div><div class="line">  <span class="keyword">var</span> bar = <span class="string">""</span>,</div><div class="line">    qux;</div><div class="line">}</div><div class="line"><span class="comment">// 好</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">var</span> bar = <span class="string">""</span>,</div><div class="line">    qux;</div><div class="line">  <span class="comment">// 所有语句都在变量之后</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>常量<br>常量的形式如: NAMES_LIKE_THIS, 即使用大写字符, 并用下划线分隔. 你也可用 @const 标记来指明它是一个常量. 但请永远不要使用 const 关键词.<br>Decision:<br>对于基本类型的常量, 只需转换命名.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * The number of seconds in a minute.</div><div class="line"> * @type {number}</div><div class="line"> */</div><div class="line">goog.example.SECONDS_IN_A_MINUTE = <span class="number">60</span>;</div></pre></td></tr></table></figure>

<p>对于非基本类型, 使用 @const 标记.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * The number of seconds in each of the given units.</div><div class="line"> * @type {Object.&lt;number&gt;}</div><div class="line"> * @const</div><div class="line"> */</div><div class="line">goog.example.SECONDS_TABLE = {</div><div class="line">  minute: <span class="number">60</span>,</div><div class="line">  hour: <span class="number">60</span> * <span class="number">60</span>,</div><div class="line">  day: <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>这标记告诉编译器它是常量.<br>至于关键词 const, 因为 IE 不能识别, 所以不要使用.<br>分号<br>总是使用分号.<br>如果仅依靠语句间的隐式分隔, 有时会很麻烦. 你自己更能清楚哪里是语句的起止. 而且有些情况下, 漏掉分号会很危险，可能会导致代码合并错误等，又比如:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1.</span></div><div class="line">MyClass.prototype.myMethod = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="number">42</span>;</div><div class="line">}  <span class="comment">// No semicolon here.</span></div><div class="line">(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="comment">// Some initialization code wrapped in a function to create a scope for locals.</span></div><div class="line">})();</div><div class="line"><span class="keyword">var</span> THINGS_TO_EAT = [apples, oysters, sprayOnCheese]  <span class="comment">// No semicolon here.</span></div><div class="line"><span class="comment">// 2. conditional execution a la bash</span></div><div class="line">-<span class="number">1</span> == resultOfOperation() || die();</div></pre></td></tr></table></figure>

<p>这段代码会发生些什么诡异事呢?<br>报 JavaScript 错误 - 例子1上的语句会解释成, 一个函数带一匿名函数作为参数而被调用, 返回42后, 又一次被”调用”, 这就导致了错误.<br>当 resultOfOperation() 返回非 NaN 时, 就会调用die, 其结果也会赋给 THINGS_TO_EAT.<br>为什么?<br>JavaScript 的语句以分号作为结束符, 除非可以非常准确推断某结束位置才会省略分号. 上面的例子产出错误, 均是在语句中声明了函数/对象/数组直接量, 但 闭括号(‘}’或’]’)并不足以表示该语句的结束. 在 JavaScript 中, 只有当语句后的下一个符号是后缀或括号运算符时, 才会认为该语句的结束. 参考：JS分号自动插入机制<br>遗漏分号有时会出现很奇怪的结果, 所以确保语句以分号结束.<br>块内函数声明<br>不要在块内声明一个函数，不要写成:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (x) {</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>{}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>虽然很多 JS 引擎都支持块内声明函数, 但它不属于 ECMAScript 规范 (见 ECMA-262, 第13和14条). 各个浏览器糟糕的实现相互不兼容, 有些也与未来 ECMAScript 草案相违背. ECMAScript 只允许在脚本的根语句或函数中声明函数. 如果确实需要在块中定义函数, 建议使用函数表达式来初始化变量:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (x) {</div><div class="line">  <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>标准特性<br>标准特性总是优于非标准特性.<br>最大化可移植性和兼容性, 尽量使用标准方法而不是用非标准方法, (比如, 优先用string.charAt(3) 而不用 string[3] , 通过 DOM 原生函数访问元素, 而不是使用应用封装好的快速接口.<br>不要封装基本类型<br>没有任何理由去封装基本类型, 另外还存在一些风险:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">false</span>);</div><div class="line"><span class="keyword">if</span> (x) {</div><div class="line">  alert(<span class="string">'hi'</span>);  <span class="comment">// Shows 'hi'.</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>除非明确用于类型转换, 其他情况请千万不要这样做！</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="built_in">Boolean</span>(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span> (x) {</div><div class="line">  alert(<span class="string">'hi'</span>);  <span class="comment">// This will never be alerted.</span></div><div class="line">}</div></pre></td></tr></table></figure>



<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> <span class="built_in">Boolean</span>(<span class="number">0</span>) == <span class="string">'boolean'</span>;</div><div class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="number">0</span>) == <span class="string">'object'</span>;</div></pre></td></tr></table></figure>

<p>有时用作 number, string 或 boolean时, 类型的转换会非常实用.<br>闭包<br>可以, 但小心使用.<br>闭包也许是 JS 中最有用的特性了. 有一份比较好的介绍闭包原理的文档.<br>有一点需要牢记, 闭包保留了一个指向它封闭作用域的指针, 所以, 在给 DOM 元素附加闭包时, 很可能会产生循环引用, 进一步导致内存泄漏. 比如下面的代码:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(element, a, b)</span> </span>{</div><div class="line">  element.onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{ <span class="comment">/* uses a and b */</span> };</div><div class="line">}</div></pre></td></tr></table></figure>

<p>这里, 即使没有使用 element, 闭包也保留了 element, a 和 b 的引用, 由于 element 也保留了对闭包的引用, 这就产生了循环引用, 这就不能被 GC 回收. 这种情况下, 可将代码重构为:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(element, a, b)</span> </span>{</div><div class="line">  element.onclick = bar(a, b);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">(a, b)</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{ <span class="comment">/* uses a and b */</span> }</div><div class="line">}</div><div class="line"><span class="built_in">eval</span>()</div></pre></td></tr></table></figure>

<p>只用于解析序列化串 (如: 解析 RPC 响应), 而且解析序列号字符串用JSON.parse()会更好，所以最好放弃使用 eval().<br>eval() 会让程序执行的比较混乱, 当 eval() 里面包含用户输入的话就更加危险. 可以用其他更佳的, 更清晰, 更安全的方式写你的代码, 所以一般情况下请不要使用 eval(). 当碰到一些需要解析序列化串的情况下(如, 计算 RPC 响应), 使用 eval 很容易实现.<br>解析序列化串是指将字节流转换成内存中的数据结构. 比如, 你可能会将一个对象输出成文件形式:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">users = [</div><div class="line">  {</div><div class="line">    name: <span class="string">'Eric'</span>,</div><div class="line">    id: <span class="number">37824</span>,</div><div class="line">    email: <span class="string">'jellyvore@myway.com'</span></div><div class="line">  },</div><div class="line">  {</div><div class="line">    name: <span class="string">'xtof'</span>,</div><div class="line">    id: <span class="number">31337</span>,</div><div class="line">    email: <span class="string">'b4d455h4x0r@google.com'</span></div><div class="line">  },</div><div class="line">  ...</div><div class="line">];</div></pre></td></tr></table></figure>

<p>很简单地调用 eval 后, 把表示成文件的数据读取回内存中.<br>类似的, eval() 对 RPC 响应值进行解码. 例如, 你在使用 XMLHttpRequest 发出一个 RPC 请求后, 通过 eval () 将服务端的响应文本转成 JavaScript 对象:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> userOnline = <span class="literal">false</span>;</div><div class="line"><span class="keyword">var</span> user = <span class="string">'nusrat'</span>;</div><div class="line"><span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">xmlhttp.open(<span class="string">'GET'</span>, <span class="string">'http://chat.google.com/isUserOnline?user='</span> + user, <span class="literal">false</span>);</div><div class="line">xmlhttp.send(<span class="string">''</span>);</div><div class="line"><span class="comment">// Server returns:</span></div><div class="line"><span class="comment">// userOnline = true;</span></div><div class="line"><span class="keyword">if</span> (xmlhttp.status == <span class="number">200</span>) {</div><div class="line">  <span class="built_in">eval</span>(xmlhttp.responseText);</div><div class="line">}</div><div class="line"><span class="comment">// userOnline is now true.</span></div><div class="line"><span class="keyword">with</span>() {}</div></pre></td></tr></table></figure>

<p>不要使用<br>使用 with 让你的代码在语义上变得不清晰. 因为 with 的对象, 可能会与局部变量产生冲突, 从而改变你程序原本的用义. 下面的代码是干嘛的?</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> (foo) {</div><div class="line">  <span class="keyword">var</span> x = <span class="number">3</span>;</div><div class="line">  <span class="keyword">return</span> x;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>答案: 任何事. 局部变量 x 可能被 foo 的属性覆盖, 当它定义一个 setter 时, 在赋值 3 后会执行很多其他代码. 所以不要使用 with 语句.<br>this<br>仅在对象构造器, 方法, 闭包中使用.<br>this 的语义很特别. 有时它引用一个全局对象(大多数情况下), 调用者的作用域(使用 eval时), DOM 树中的节点(添加事件处理函数时), 新创建的对象(使用一个构造器), 或者其他对象(如果函数被 call() 或 apply()).<br>使用时很容易出错, 所以只有在下面两个情况时才能使用:<br>在构造器中<br>对象的方法(包括创建的闭包)中<br>for-in 循环<br>只用于 object/map/hash 的遍历<br>对 Array 用 for-in 循环有时会出错. 因为它并不是从 0 到 length - 1 进行遍历, 而是所有出现在对象及其原型链的键值. 下面就是一些失败的使用案例:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">printArray</span><span class="params">(arr)</span> </span>{</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> arr) {</div><div class="line">    print(arr[key]);</div><div class="line">  }</div><div class="line">}</div><div class="line">printArray([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);  <span class="comment">// This works.</span></div><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>);</div><div class="line">printArray(a);  <span class="comment">// This is wrong.</span></div><div class="line">a = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'*'</span>);</div><div class="line">printArray(a);  <span class="comment">// This is wrong.</span></div><div class="line">a = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line">a.buhu = <span class="string">'wine'</span>;</div><div class="line">printArray(a);  <span class="comment">// This is wrong again.</span></div><div class="line">a = <span class="keyword">new</span> <span class="built_in">Array</span>;</div><div class="line">a[<span class="number">3</span>] = <span class="number">3</span>;</div><div class="line">printArray(a);  <span class="comment">// This is wrong again.</span></div><div class="line"><span class="comment">// 而遍历数组通常用最普通的 for 循环.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">printArray</span><span class="params">(arr)</span> </span>{</div><div class="line">  <span class="keyword">var</span> l = arr.length;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; l; i++) {</div><div class="line">    print(arr[i]);</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>多行字符串<br>不要使用. 不要这样写长字符串:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myString = <span class="string">'A rather long string of English text, an error message \</span></div><div class="line">                actually that just keeps going and going -- an error \</div><div class="line">                message to make the Energizer bunny blush (right through \</div><div class="line">                those Schwarzenegger shades)! Where was I? Oh yes, \</div><div class="line">                you\'ve got an error and all the extraneous whitespace is \</div><div class="line">                just gravy.  Have a nice day.';</div></pre></td></tr></table></figure>

<p>在编译时, 不能忽略行起始位置的空白字符; “\” 后的空白字符会产生奇怪的错误; 虽然大多数脚本引擎支持这种写法, 但它不是 ECMAScript 的标准规范.<br>Array 和 Object 直接量<br>使用 Array 和 Object 语法, 而不使用 Array 和 Object 构造器.<br>使用 Array 构造器很容易因为传参不恰当导致错误.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Length is 3.</span></div><div class="line"><span class="keyword">var</span> a1 = <span class="keyword">new</span> <span class="built_in">Array</span>(x1, x2, x3);</div><div class="line"><span class="comment">// Length is 2.</span></div><div class="line"><span class="keyword">var</span> a2 = <span class="keyword">new</span> <span class="built_in">Array</span>(x1, x2);</div><div class="line"><span class="comment">// If x1 is a number and it is a natural number the length will be x1.</span></div><div class="line"><span class="comment">// If x1 is a number but not a natural number this will throw an exception.</span></div><div class="line"><span class="comment">// Otherwise the array will have one element with x1 as its value.</span></div><div class="line"><span class="keyword">var</span> a3 = <span class="keyword">new</span> <span class="built_in">Array</span>(x1);</div><div class="line"><span class="comment">// Length is 0.</span></div><div class="line"><span class="keyword">var</span> a4 = <span class="keyword">new</span> <span class="built_in">Array</span>();</div></pre></td></tr></table></figure>

<p>如果传入一个参数而不是2个参数, 数组的长度很有可能就不是你期望的数值了.<br>为了避免这些歧义, 我们应该使用更易读的直接量来声明.</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [x1, x2, x3];</div><div class="line"><span class="keyword">var</span> a2 = [x1, x2];</div><div class="line"><span class="keyword">var</span> a3 = [x1];</div><div class="line"><span class="keyword">var</span> a4 = [];</div></pre></td></tr></table></figure>

<p>虽然 Object 构造器没有上述类似的问题, 但鉴于可读性和一致性考虑, 最好还是在字面上更清晰地指明. 例如：</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line"><span class="keyword">var</span> o2 = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">o2.a = <span class="number">0</span>;</div><div class="line">o2.b = <span class="number">1</span>;</div><div class="line">o2.c = <span class="number">2</span>;</div><div class="line">o2[<span class="string">'strange key'</span>] = <span class="number">3</span>;</div></pre></td></tr></table></figure>

<p>应该写成:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = {};</div><div class="line"><span class="keyword">var</span> o2 = {</div><div class="line">  a: <span class="number">0</span>,</div><div class="line">  b: <span class="number">1</span>,</div><div class="line">  c: <span class="number">2</span>,</div><div class="line">  <span class="string">'strange key'</span>: <span class="number">3</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>不要修改内置对象的原型<br>千万不要修改内置对象, 如 Object.prototype 和 Array.prototype 的原型. 而修改内置对象, 如 Function.prototype 的原型, 虽然少危险些, 但仍会导致调试时的诡异现象. 所以也要避免修改其原型.<br>JavaScript 小技巧(Tips and Tricks)<br>True 和 False 布尔表达式<br>下面的布尔表达式都返回 false:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="literal">null</span></div><div class="line"><span class="literal">undefined</span></div><div class="line"><span class="string">''</span>          <span class="comment">// 空字符串</span></div><div class="line"><span class="number">0</span>           <span class="comment">//数字0</span></div></pre></td></tr></table></figure>

<p>但小心下面的, 可都返回 true:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">'0'</span>   <span class="comment">// 字符串0</span></div><div class="line">[]    <span class="comment">// 空数组</span></div><div class="line">{}    <span class="comment">// 空对象</span></div></pre></td></tr></table></figure>

<p>下面段比较糟糕的代码:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> (x != <span class="literal">null</span>) {</div></pre></td></tr></table></figure>

<p>你可以直接写成下面的形式(只要你希望 x 不是 0 和空字符串, 和 false):</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> (x) {</div></pre></td></tr></table></figure>

<p>如果你想检查字符串是否为 null 或空:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (y != <span class="literal">null</span> && y != <span class="string">''</span>) {</div></pre></td></tr></table></figure>

<p>但这样会更好:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (y) {</div></pre></td></tr></table></figure>

<p>注意: 还有很多需要注意的地方, 如:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Boolean</span>(<span class="string">'0'</span>) == <span class="literal">true</span></div><div class="line"><span class="string">'0'</span> != <span class="literal">true</span></div><div class="line"><span class="number">0</span> != <span class="literal">null</span></div><div class="line"><span class="number">0</span> == []</div><div class="line"><span class="number">0</span> == <span class="literal">false</span></div><div class="line"><span class="built_in">Boolean</span>(<span class="literal">null</span>) == <span class="literal">false</span></div><div class="line"><span class="literal">null</span> != <span class="literal">true</span></div><div class="line"><span class="literal">null</span> != <span class="literal">false</span></div><div class="line"><span class="built_in">Boolean</span>(<span class="literal">undefined</span>) == <span class="literal">false</span></div><div class="line"><span class="literal">undefined</span> != <span class="literal">true</span></div><div class="line"><span class="literal">undefined</span> != <span class="literal">false</span></div><div class="line"><span class="built_in">Boolean</span>([]) == <span class="literal">true</span></div><div class="line">[] != <span class="literal">true</span></div><div class="line">[] == <span class="literal">false</span></div><div class="line"><span class="built_in">Boolean</span>({}) == <span class="literal">true</span></div><div class="line">{} != <span class="literal">true</span></div><div class="line">{} != <span class="literal">false</span></div><div class="line">条件(三元)操作符 (?:)</div></pre></td></tr></table></figure>

<p>三元操作符用于替代下面的代码:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (val != <span class="number">0</span>) {</div><div class="line">  <span class="keyword">return</span> foo();</div><div class="line">} <span class="keyword">else</span> {</div><div class="line">  <span class="keyword">return</span> bar();</div><div class="line">}</div></pre></td></tr></table></figure>

<p>你可以写成:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> val ? foo() : bar();</div></pre></td></tr></table></figure>

<p>在生成 HTML 代码时也是很有用的:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> html = <span class="string">'&lt;input type="checkbox"'</span> +</div><div class="line">    (isChecked ? <span class="string">' checked'</span> : <span class="string">''</span>) +</div><div class="line">    (isEnabled ? <span class="string">''</span> : <span class="string">' disabled'</span>) +</div><div class="line">    <span class="string">' name="foo"&gt;'</span>;</div></pre></td></tr></table></figure>

<p>&amp;&amp; 和 ||<br>二元布尔操作符是可短路的, 只有在必要时才会计算到最后一项.<br>“||” 被称作为 ‘default’ 操作符, 因为可以这样:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** @param {*=} opt_win */</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(opt_win)</span> </span>{</div><div class="line">  <span class="keyword">var</span> win;</div><div class="line">  <span class="keyword">if</span> (opt_win) {</div><div class="line">    win = opt_win;</div><div class="line">  } <span class="keyword">else</span> {</div><div class="line">    win = <span class="built_in">window</span>;</div><div class="line">  }</div><div class="line">  <span class="comment">// ...</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>你可以使用它来简化上面的代码:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** @param {*=} opt_win */</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(opt_win)</span> </span>{</div><div class="line">  <span class="keyword">var</span> win = opt_win || <span class="built_in">window</span>;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>“&amp;&amp;” 也可简短代码.比如:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (node) {</div><div class="line">  <span class="keyword">if</span> (node.kids) {</div><div class="line">    <span class="keyword">if</span> (node.kids[index]) {</div><div class="line">      foo(node.kids[index]);</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>你可以像这样来使用:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (node && node.kids && node.kids[index]) {</div><div class="line">  foo(node.kids[index]);</div><div class="line">}</div></pre></td></tr></table></figure>

<p>或者:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> kid = node && node.kids && node.kids[index];</div><div class="line"><span class="keyword">if</span> (kid) {</div><div class="line">  foo(kid);</div><div class="line">}</div></pre></td></tr></table></figure>

<p>不过这样就有点儿过头了:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node && node.kids && node.kids[index] && foo(node.kids[index]);</div></pre></td></tr></table></figure>

<p>使用 join() 来创建字符串<br>通常是这样使用的:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listHtml</span><span class="params">(items)</span> </span>{</div><div class="line">  <span class="keyword">var</span> html = <span class="string">'&lt;div class="foo"&gt;'</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.length; ++i) {</div><div class="line">    <span class="keyword">if</span> (i &gt; <span class="number">0</span>) {</div><div class="line">      html += <span class="string">', '</span>;</div><div class="line">    }</div><div class="line">    html += itemHtml(items[i]);</div><div class="line">  }</div><div class="line">  html += <span class="string">'&lt;/div&gt;'</span>;</div><div class="line">  <span class="keyword">return</span> html;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>但这样在 IE 下非常慢, 可以用下面的方式:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listHtml</span><span class="params">(items)</span> </span>{</div><div class="line">  <span class="keyword">var</span> html = [];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.length; ++i) {</div><div class="line">    html[i] = itemHtml(items[i]);</div><div class="line">  }</div><div class="line">  <span class="keyword">return</span> <span class="string">'&lt;div class="foo"&gt;'</span> + html.join(<span class="string">', '</span>) + <span class="string">'&lt;/div&gt;'</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>你也可以是用数组作为字符串构造器, 然后通过 myArray.join(‘’) 转换成字符串. 不过由于赋值操作快于数组的 push(), 所以尽量使用赋值操作.<br>类型检测 (来源于 jQuery Core Style Guidelines)<br>直接类型（实际类型，Actual Types）</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>:</div><div class="line">  <span class="keyword">typeof</span> variable === <span class="string">"string"</span></div><div class="line"><span class="built_in">Number</span>:</div><div class="line">  <span class="keyword">typeof</span> variable === <span class="string">"number"</span></div><div class="line"><span class="built_in">Boolean</span>:</div><div class="line">  <span class="keyword">typeof</span> variable === <span class="string">"boolean"</span></div><div class="line"><span class="built_in">Object</span>:</div><div class="line">  <span class="keyword">typeof</span> variable === <span class="string">"object"</span></div><div class="line"><span class="built_in">Array</span>:</div><div class="line">  <span class="built_in">Array</span>.isArray(arrayLikeObject)</div><div class="line">  (如果可能的话)</div><div class="line">Node:</div><div class="line">  elem.nodeType === <span class="number">1</span></div><div class="line"><span class="literal">null</span>:</div><div class="line">  variable === <span class="literal">null</span></div><div class="line"><span class="literal">null</span> or <span class="literal">undefined</span>:</div><div class="line">  variable == <span class="literal">null</span></div><div class="line"><span class="literal">undefined</span>:</div><div class="line">全局变量:</div><div class="line"></div><div class="line">  <span class="keyword">typeof</span> variable === <span class="string">"undefined"</span></div><div class="line"></div><div class="line">局部变量:</div><div class="line"></div><div class="line">  variable === <span class="literal">undefined</span></div><div class="line"></div><div class="line">属性:</div><div class="line"></div><div class="line">  object.prop === <span class="literal">undefined</span></div><div class="line">  object.hasOwnProperty(prop)</div><div class="line">  <span class="string">"prop"</span> <span class="keyword">in</span> object</div></pre></td></tr></table></figure>

<p>转换类型（强制类型，Coerced Types）<br>考虑下面这个的含义…<br>给定的 HTML:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">id</span>=<span class="value">"foo-input"</span> <span class="attribute">value</span>=<span class="value">"1"</span>&gt;</span></div></pre></td></tr></table></figure>



<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// `foo` 已经被赋予值 `0`，类型为 `number`</span></div><div class="line"><span class="keyword">var</span> foo = <span class="number">0</span>;</div><div class="line"><span class="comment">// typeof foo;</span></div><div class="line"><span class="comment">// "number"</span></div><div class="line">...</div><div class="line"><span class="comment">// 在后续的代码中，你需要更新 `foo`，赋予在 input 元素中得到的新值</span></div><div class="line">foo = <span class="built_in">document</span>.getElementById(<span class="string">"foo-input"</span>).value;</div><div class="line"><span class="comment">// 如果你现在测试 `typeof foo`, 结果将是 `string`</span></div><div class="line"><span class="comment">// 这意味着你在 if 语句检测 `foo` 有类似于此的逻辑:</span></div><div class="line"><span class="keyword">if</span> (foo === <span class="number">1</span>) {</div><div class="line">  importantTask();</div><div class="line">}</div><div class="line"><span class="comment">// `importantTask()` 将永远不会被执行，即使 `foo` 有一个值 "1"</span></div><div class="line"><span class="comment">// 你可以巧妙地使用 + / - 一元运算符强制转换类型以解决问题:</span></div><div class="line">foo = +<span class="built_in">document</span>.getElementById(<span class="string">"foo-input"</span>).value;</div><div class="line"><span class="comment">//    ^ + 一元运算符将它右边的运算对象转换为 `number`</span></div><div class="line"><span class="comment">// typeof foo;</span></div><div class="line"><span class="comment">// "number"</span></div><div class="line"><span class="keyword">if</span> (foo === <span class="number">1</span>) {</div><div class="line">  importantTask();</div><div class="line">}</div><div class="line"><span class="comment">// `importantTask()` 将被调用</span></div></pre></td></tr></table></figure>

<p>对于强制类型转换这里有几个例子:</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> number = <span class="number">1</span>,</div><div class="line">  string = <span class="string">"1"</span>,</div><div class="line">  bool = <span class="literal">false</span>;</div><div class="line">number;</div><div class="line"><span class="comment">// 1</span></div><div class="line">number + <span class="string">""</span>;</div><div class="line"><span class="comment">// "1"</span></div><div class="line">string;</div><div class="line"><span class="comment">// "1"</span></div><div class="line">+string;</div><div class="line"><span class="comment">// 1</span></div><div class="line">+string++;</div><div class="line"><span class="comment">// 1</span></div><div class="line">string;</div><div class="line"><span class="comment">// 2</span></div><div class="line">bool;</div><div class="line"><span class="comment">// false</span></div><div class="line">+bool;</div><div class="line"><span class="comment">// 0</span></div><div class="line">bool + <span class="string">""</span>;</div><div class="line"><span class="comment">// "false"</span></div></pre></td></tr></table></figure>



<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> number = <span class="number">1</span>,</div><div class="line">  string = <span class="string">"1"</span>,</div><div class="line">  bool = <span class="literal">true</span>;</div><div class="line">string === number;</div><div class="line"><span class="comment">// false</span></div><div class="line">string === number + <span class="string">""</span>;</div><div class="line"><span class="comment">// true</span></div><div class="line">+string === number;</div><div class="line"><span class="comment">// true</span></div><div class="line">bool === number;</div><div class="line"><span class="comment">// false</span></div><div class="line">+bool === number;</div><div class="line"><span class="comment">// true</span></div><div class="line">bool === string;</div><div class="line"><span class="comment">// false</span></div><div class="line">bool === !!string;</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>



<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="number">2.5</span>;</div><div class="line"><span class="built_in">parseInt</span>(num, <span class="number">10</span>);</div><div class="line"><span class="comment">// 等价于...</span></div><div class="line">~~num;</div><div class="line">num &gt;&gt; <span class="number">0</span>;</div><div class="line">num &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line"><span class="comment">// 结果都是 2</span></div><div class="line"><span class="comment">// 时刻牢记心底, 负值将被区别对待...</span></div><div class="line"><span class="keyword">var</span> neg = -<span class="number">2.5</span>;</div><div class="line"><span class="built_in">parseInt</span>(neg, <span class="number">10</span>);</div><div class="line"><span class="comment">// 等价于...</span></div><div class="line">~~neg;</div><div class="line">neg &gt;&gt; <span class="number">0</span>;</div><div class="line"><span class="comment">// 结果都是 -2</span></div><div class="line"><span class="comment">// 但是...</span></div><div class="line">neg &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line"><span class="comment">// 结果即是 4294967294</span></div></pre></td></tr></table></figure>

<p>字符串转换为整数<br>将字符串转换为整数有以下几种方式，可以在这里进行测试对比：</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> number1 = <span class="string">"45"</span>;</div><div class="line"><span class="comment">// ParseInt() Test on chrome for mac:31% slower</span></div><div class="line"><span class="keyword">var</span> i = <span class="built_in">parseInt</span>(number1);</div><div class="line"><span class="comment">// Using unary Test on chrome for mac:67% slower</span></div><div class="line"><span class="keyword">var</span> j = +number1;</div><div class="line"><span class="comment">// Number constructor Test on chrome for mac:59% slower</span></div><div class="line"><span class="keyword">var</span> k = <span class="built_in">Number</span>(number1);</div><div class="line"><span class="comment">// By multplication Test on chrome for mac:69% slower</span></div><div class="line"><span class="keyword">var</span> l = number1 * <span class="number">1</span>;</div><div class="line"><span class="comment">// parseInt with Test on chrome for mac:radix ±3.85% fastest</span></div><div class="line"><span class="keyword">var</span> m = <span class="built_in">parseInt</span>(number1, <span class="number">10</span>);</div></pre></td></tr></table></figure>

<p>所以推荐使用 parseInt(number1, 10) 这种方式，不过 +number1 更为简单，在操作次数极少的情况下也可以酌情使用。<br>对比运算</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 当只是判断一个 array 是否有长度，相对于使用这个:</span></div><div class="line"><span class="keyword">if</span> (array.length &gt; <span class="number">0</span>) ...</div><div class="line"><span class="comment">// ...判断真伪, 请使用这种:</span></div><div class="line"><span class="keyword">if</span> (array.length) ...</div><div class="line"><span class="comment">// 当只是判断一个 array 是否为空，相对于使用这个:</span></div><div class="line"><span class="keyword">if</span> (array.length === <span class="number">0</span>) ...</div><div class="line"><span class="comment">// ...判断真伪, 请使用这种:</span></div><div class="line"><span class="keyword">if</span> (!array.length) ...</div><div class="line"><span class="comment">// 当只是判断一个 string 是否为空，相对于使用这个:</span></div><div class="line"><span class="keyword">if</span> (string !== <span class="string">""</span>) ...</div><div class="line"><span class="comment">// ...判断真伪, 请使用这种:</span></div><div class="line"><span class="keyword">if</span> (string) ...</div><div class="line"><span class="comment">// 当只是判断一个 string 是为空，相对于使用这个:</span></div><div class="line"><span class="keyword">if</span> (string === <span class="string">""</span>) ...</div><div class="line"><span class="comment">// ...判断真伪, 请使用这种:</span></div><div class="line"><span class="keyword">if</span> (!string) ...</div><div class="line"><span class="comment">// 当只是判断一个引用是为真，相对于使用这个:</span></div><div class="line"><span class="keyword">if</span> (foo === <span class="literal">true</span>) ...</div><div class="line"><span class="comment">// ...判断只需像你所想，享受内置功能的好处:</span></div><div class="line"><span class="keyword">if</span> (foo) ...</div><div class="line"><span class="comment">// 当只是判断一个引用是为假，相对于使用这个:</span></div><div class="line"><span class="keyword">if</span> (foo === <span class="literal">false</span>) ...</div><div class="line"><span class="comment">// ...使用叹号将其转换为真</span></div><div class="line"><span class="keyword">if</span> (!foo) ...</div><div class="line"><span class="comment">// ...需要注意的是：这个将会匹配 0, "", null, undefined, NaN</span></div><div class="line"><span class="comment">// 如果你 _必须_ 是布尔类型的 false，请这样用：</span></div><div class="line"><span class="keyword">if</span> (foo === <span class="literal">false</span>) ...</div><div class="line"><span class="comment">// 如果想计算一个引用可能是 null 或者 undefined，但并不是 false, "" 或者 0,</span></div><div class="line"><span class="comment">// 相对于使用这个：</span></div><div class="line"><span class="keyword">if</span> (foo === <span class="literal">null</span> || foo === <span class="literal">undefined</span>) ...</div><div class="line"><span class="comment">// ...享受 == 类型强制转换的好处，像这样:</span></div><div class="line"><span class="keyword">if</span> (foo == <span class="literal">null</span>) ...</div><div class="line"><span class="comment">// 谨记，使用 == 将会令 `null` 匹配 `null` 和 `undefined`</span></div><div class="line"><span class="comment">// 但不是 `false`，"" 或者 0</span></div><div class="line"><span class="literal">null</span> == <span class="literal">undefined</span></div></pre></td></tr></table></figure>

<p>总是判断最好、最精确的值，上述是指南而非教条。</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 类型转换和对比运算说明</span></div><div class="line"><span class="comment">// 首次 `===`，`==` 次之 (除非需要松散类型的对比)</span></div><div class="line"><span class="comment">// `===` 总不做类型转换，这意味着:</span></div><div class="line"><span class="string">"1"</span> === <span class="number">1</span>;</div><div class="line"><span class="comment">// false</span></div><div class="line"><span class="comment">// `==` 会转换类型，这意味着:</span></div><div class="line"><span class="string">"1"</span> == <span class="number">1</span>;</div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="comment">// 布尔, 真 & 伪</span></div><div class="line"><span class="comment">// 布尔:</span></div><div class="line"><span class="literal">true</span>, <span class="literal">false</span></div><div class="line"><span class="comment">// 真:</span></div><div class="line"><span class="string">"foo"</span>, <span class="number">1</span></div><div class="line"><span class="comment">// 伪:</span></div><div class="line"><span class="string">""</span>, <span class="number">0</span>, <span class="literal">null</span>, <span class="literal">undefined</span>, <span class="literal">NaN</span>, <span class="keyword">void</span> <span class="number">0</span></div><div class="line">Misc</div></pre></td></tr></table></figure>

<p>这个部分将要说明的想法和理念都并非教条。相反更鼓励对现存实践保持好奇，以尝试提供完成一般 JavaScript 编程任务的更好方案。<br>提前返回值提升代码的可读性并且没有太多性能上的差别</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不好:</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">returnLate</span><span class="params">(foo)</span> </span>{</div><div class="line">  <span class="keyword">var</span> ret;</div><div class="line">  <span class="keyword">if</span> (foo) {</div><div class="line">    ret = <span class="string">"foo"</span>;</div><div class="line">  } <span class="keyword">else</span> {</div><div class="line">    ret = <span class="string">"quux"</span>;</div><div class="line">  }</div><div class="line">  <span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="comment">// 好:</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">returnEarly</span><span class="params">(foo)</span> </span>{</div><div class="line">  <span class="keyword">if</span> (foo) {</div><div class="line">    <span class="keyword">return</span> <span class="string">"foo"</span>;</div><div class="line">  }</div><div class="line">  <span class="keyword">return</span> <span class="string">"quux"</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>for循环遍历</p>
<figure class="highlight javaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// for循环遍历:</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, l = arr.length; i &lt; l; i++){</div><div class="line">    <span class="comment">// doSomething here</span></div><div class="line">}</div><div class="line"><span class="comment">// 上面的方式优于:</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++){</div><div class="line">    <span class="comment">// doSomething here</span></div><div class="line">}</div><div class="line"><span class="comment">// 前一种方式只会计算一次 arr 的长度，而后一种方式会计算 arr.length + 1 次，效率比较低</span></div></pre></td></tr></table></figure>

<p>保持一致性.<br>当你在编辑代码之前, 先花一些时间查看一下现有代码的风格. 如果他们给算术运算符添加了空格, 你也应该添加. 如果他们的注释使用一个个星号盒子, 那么也请你使用这种方式.<br>代码风格中一个关键点是整理一份常用词汇表, 开发者认同它并且遵循, 这样在代码中就能统一表述. 我们在这提出了一些全局上的风格规则, 但也要考虑自身情况形成自己的代码风格. 但如果你添加的代码和现有的代码有很大的区别, 这就让阅读者感到很不和谐. 所以, 避免这种情况的发生.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>以下文档大多来自:</p>
<ul>
<li><a href="http://wyz.67ge.com/google-js/javascriptguide.xml" target="_blank" rel="external">Google JavaScript 编码规范指]]>
    </summary>
    
      <category term="JavaScript" scheme="http://lawrence-zxc.github.io/tags/JavaScript/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://lawrence-zxc.github.io/2013/11/13/hello-world/"/>
    <id>http://lawrence-zxc.github.io/2013/11/13/hello-world/</id>
    <published>2013-11-13T02:15:01.000Z</published>
    <updated>2014-10-27T03:03:42.000Z</updated>
    <content type="html"><![CDATA[<p>Welcome to Lawrence-zxc’s Blog! Thank you!</p>
<h3 id="for_Java">for Java</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"Hello World!"</span>);</div></pre></td></tr></table></figure>



<h3 id="for_Shell">for Shell</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">"Hello World!"</span></div><div class="line"><span class="built_in">printf</span> <span class="string">"Hello world!"</span></div></pre></td></tr></table></figure>



<h3 id="for_JavaScript">for JavaScript</h3>
<figure class="highlight JavaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">"Hello World!"</span>);</div><div class="line"><span class="built_in">document</span>.write(<span class="string">"Hello, world!"</span>);</div></pre></td></tr></table></figure>



<h3 id="for_Css">for Css</h3>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">*<span class="pseudo">:before</span>,</div><div class="line">*<span class="pseudo">:after</span> <span class="rules">{ <span class="rule"><span class="attribute">content</span>:<span class="value"><span class="string">'hello word!'</span> </span></span></span>}</div></pre></td></tr></table></figure>



<h3 id="for_Python">for Python</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line">print(<span class="string">"hello world!"</span>)</div></pre></td></tr></table></figure>



<h3 id="for_Ruby">for Ruby</h3>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">puts <span class="string">"Hello World!"</span></div></pre></td></tr></table></figure>



<h3 id="for_C">for C</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Hello, world!"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="for_Perl">for Perl</h3>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> <span class="string">"Hello, World.\n"</span>;</div></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to Lawrence-zxc’s Blog! Thank you!</p>
<h3 id="for_Java">for Java</h3>
<figure class="highlight java"><table><tr><td class="gutte]]>
    </summary>
    
      <category term="开始" scheme="http://lawrence-zxc.github.io/tags/%E5%BC%80%E5%A7%8B/"/>
    
      <category term="Java" scheme="http://lawrence-zxc.github.io/tags/Java/"/>
    
      <category term="JavaScript" scheme="http://lawrence-zxc.github.io/tags/JavaScript/"/>
    
      <category term="日志" scheme="http://lawrence-zxc.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
</feed>
